"use strict";var wo=Object.defineProperty;var So=(e,t,n)=>t in e?wo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var J=(e,t,n)=>(So(e,typeof t!="symbol"?t+"":t,n),n);const he=require("siyuan");const No=`<symbol id="icon-custom-block-menu" viewBox="0 0 1024 1024">
    <path
        d="M520 943.712a8 8 0 0 1-8-8v-416a8 8 0 0 1 8-8h416a8 8 0 0 1 8 8v416a8 8 0 0 1-8 8h-416z"
        fill="#80C33C"
    />
    <path
        d="M920 535.712v384h-384v-384h384m16-48h-416a32 32 0 0 0-32 32v416a32 32 0 0 0 32 32h416a32 32 0 0 0 32-32v-416a32 32 0 0 0-32-32z"
        fill="#3A7033"
    />
    <path
        d="M88 894.688a8 8 0 0 1-8-8v-416a8 8 0 0 1 8-8h416a8 8 0 0 1 8 8v416a8 8 0 0 1-8 8h-416z"
        fill="#E4001D"
    />
    <path
        d="M488 486.688v384h-384v-384h384m16-48h-416a32 32 0 0 0-32 32v416a32 32 0 0 0 32 32h416a32 32 0 0 0 32-32v-416a32 32 0 0 0-32-32z"
        fill="#8C031A"
    />
    <path
        d="M264.864 512.288a8 8 0 0 1-8-8v-416a8 8 0 0 1 8-8h416a8 8 0 0 1 8 8v416a8 8 0 0 1-8 8h-416z"
        fill="#2AB2EC"
    />
    <path
        d="M664.864 104.288v384h-384v-384h384m16-48h-416a32 32 0 0 0-32 32v416a32 32 0 0 0 32 32h416a32 32 0 0 0 32-32v-416a32 32 0 0 0-32-32z"
        fill="#0181B8"
    />
</symbol>
`,vo=`<symbol id="icon-custom-block-render-danmaku" viewBox="0 0 1024 1024">
    <path
        d="M1024 512c0 282.7264-229.1712 512-512 512-282.7776 0-512-229.2736-512-512C0 229.2224 229.2224 0 512 0c282.8288 0 512 229.2224 512 512"
        fill="#9966FF"
    />
    <path
        d="M256 256m51.2 0l409.6 0q51.2 0 51.2 51.2l0 0q0 51.2-51.2 51.2l-409.6 0q-51.2 0-51.2-51.2l0 0q0-51.2 51.2-51.2Z"
        fill="#FFFFFF"
    />
    <path
        d="M256 460.8m51.2 0l409.6 0q51.2 0 51.2 51.2l0 0q0 51.2-51.2 51.2l-409.6 0q-51.2 0-51.2-51.2l0 0q0-51.2 51.2-51.2Z"
        fill="#FFFFFF"
    />
    <path
        d="M256 665.6m51.2 0l204.8 0q51.2 0 51.2 51.2l0 0q0 51.2-51.2 51.2l-204.8 0q-51.2 0-51.2-51.2l0 0q0-51.2 51.2-51.2Z"
        fill="#FFFFFF"
    />
</symbol>
`,Eo=`<symbol id="icon-custom-block-width-auto" viewBox="0 0 1024 1024">
    <path
        d="M113.777 819.198 113.777 204.8c0-50.267 40.75-91.022 91.02-91.022l614.376 0c50.29 0 91.045 40.755 91.045 91.022l0 614.398c0 50.27-40.755 91.02-91.045 91.02L204.797 910.218C154.527 910.218 113.777 869.468 113.777 819.198zM796.438 841.953c25.125 0 45.51-20.385 45.51-45.51L841.948 227.554c0-25.122-20.385-45.51-45.505-45.51L227.552 182.044c-25.125 0-45.535 20.387-45.535 45.51l0 568.889c0 25.125 20.39 45.51 45.535 45.51L796.438 841.953zM623.043 603.269l57.115-57.14L344.357 546.129l55.5 55.505c13.31 13.335 13.335 34.93 0 48.265-13.335 13.33-34.95 13.33-48.29 0l-105.765-105.77c-3.415-1.615-6.78-3.525-9.625-6.37-7.08-7.1-10.1-16.475-9.67-25.76-0.46-9.262 2.59-18.66 9.69-25.76 2.85-2.842 6.15-4.8 9.58-6.348l105.79-105.79c13.34-13.335 34.955-13.335 48.29 0 13.31 13.332 13.335 34.927 0 48.262l-55.5 55.502 335.802 0-57.115-57.117c-13.355-13.335-13.335-34.952 0-48.287s34.93-13.335 48.265 0l115.37 115.395c13.335 13.332 13.36 34.927 0 48.262l-115.37 115.395c-13.335 13.335-34.95 13.335-48.265 0C609.708 638.198 609.708 616.583 623.043 603.269z"
    />
</symbol>
`,To=`<symbol id="icon-custom-block-width-equal" viewBox="0 0 1024 1024">
    <path
        d="M367.8 321.3H188.2c-68.2 0-123.6 55.5-123.6 123.6L64.2 836c0 68.2 55.5 123.6 123.6 123.6h179.6c68.2 0 123.6-55.5 123.6-123.6l0.4-391.1c0.1-68.1-55.4-123.6-123.6-123.6z m39.5 123.6l-0.4 391.1c0 21.8-17.7 39.5-39.5 39.5H187.8c-21.8 0-39.5-17.7-39.5-39.5l0.4-391.1c0-21.8 17.7-39.5 39.5-39.5h179.6c21.8 0.1 39.5 17.8 39.5 39.5zM836 321.3H656.4c-68.2 0-123.6 55.5-123.6 123.6v229.3c0 68.2 55.5 123.6 123.6 123.6H836c68.2 0 123.6-55.5 123.6-123.6V444.9c0.1-68.1-55.4-123.6-123.6-123.6z m39.6 123.6v229.3c0 21.8-17.7 39.5-39.5 39.5H656.5c-21.8 0-39.5-17.7-39.5-39.5V444.9c0-21.8 17.7-39.5 39.5-39.5h179.6c21.8 0.1 39.5 17.8 39.5 39.5z"
    />
    <path
        d="M880.1 233.4v-94.7c0-22.1 17.9-40 40-40s40 17.9 40 40v94.7c0 22.1-17.9 40-40 40s-40-17.9-40-40zM533.5 233.4v-94.7c0-22.1 17.9-40 40-40s40 17.9 40 40v94.7c0 22.1-17.9 40-40 40s-40-17.9-40-40z"
    />
    <path
        d="M554.1 186c0-22.1 15.4-40 34.5-40h309.3c19 0 34.5 17.9 34.5 40s-15.4 40-34.5 40H588.6c-19 0-34.5-17.9-34.5-40z"
    />
    <path
        d="M410.9 233.4v-94.7c0-22.1 17.9-40 40-40s40 17.9 40 40v94.7c0 22.1-17.9 40-40 40s-40-17.9-40-40zM64.3 233.4v-94.7c0-22.1 17.9-40 40-40s40 17.9 40 40v94.7c0 22.1-17.9 40-40 40s-40-17.9-40-40z"
    />
    <path
        d="M84.9 186c0-22.1 15.4-40 34.5-40h309.3c19 0 34.5 17.9 34.5 40s-15.4 40-34.5 40H119.4c-19.1 0-34.5-17.9-34.5-40z"
    />
</symbol>
`;var Ao=Object.defineProperty,Oo=(e,t,n)=>t in e?Ao(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,se=(e,t,n)=>(Oo(e,typeof t!="symbol"?t+"":t,n),n);const Bo=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Co=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Do=/^\s*["[{]|^\s*-?\d[\d.]{0,14}\s*$/;function Ro(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Po(e);return}return t}function Po(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function Mo(e,t={}){if(typeof e!="string")return e;const n=e.trim();if(e[0]==='"'&&e[e.length-1]==='"')return n.slice(1,-1);if(n.length<=9){const o=n.toLowerCase();if(o==="true")return!0;if(o==="false")return!1;if(o==="undefined")return;if(o==="null")return null;if(o==="nan")return Number.NaN;if(o==="infinity")return Number.POSITIVE_INFINITY;if(o==="-infinity")return Number.NEGATIVE_INFINITY}if(!Do.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(Bo.test(e)||Co.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,Ro)}return JSON.parse(e)}catch(o){if(t.strict)throw o;return e}}const qo=/#/g,Fo=/&/g,Lo=/=/g,_t=/\+/g,jo=/%5e/gi,Io=/%60/gi,Uo=/%7c/gi,zo=/%20/gi;function Ho(e){return encodeURI(""+e).replace(Uo,"|")}function lt(e){return Ho(typeof e=="string"?e:JSON.stringify(e)).replace(_t,"%2B").replace(zo,"+").replace(qo,"%23").replace(Fo,"%26").replace(Io,"`").replace(jo,"^")}function et(e){return lt(e).replace(Lo,"%3D")}function An(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function Wo(e){return An(e.replace(_t," "))}function Vo(e){return An(e.replace(_t," "))}function Go(e=""){const t={};e[0]==="?"&&(e=e.slice(1));for(const n of e.split("&")){const o=n.match(/([^=]+)=?(.*)/)||[];if(o.length<2)continue;const r=Wo(o[1]);if(r==="__proto__"||r==="constructor")continue;const s=Vo(o[2]||"");t[r]===void 0?t[r]=s:Array.isArray(t[r])?t[r].push(s):t[r]=[t[r],s]}return t}function Jo(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(n=>`${et(e)}=${lt(n)}`).join("&"):`${et(e)}=${lt(t)}`:et(e)}function Ko(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>Jo(t,e[t])).filter(Boolean).join("&")}const Qo=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,Yo=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Zo=/^([/\\]\s*){2,}[^/\\]/;function On(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?Qo.test(e):Yo.test(e)||(t.acceptRelative?Zo.test(e):!1)}const Xo=/\/$|\/\?/;function ct(e="",t=!1){return t?Xo.test(e):e.endsWith("/")}function xo(e="",t=!1){if(!t)return(ct(e)?e.slice(0,-1):e)||"/";if(!ct(e,!0))return e||"/";const[n,...o]=e.split("?");return(n.slice(0,-1)||"/")+(o.length>0?`?${o.join("?")}`:"")}function $o(e="",t=!1){if(!t)return e.endsWith("/")?e:e+"/";if(ct(e,!0))return e||"/";const[n,...o]=e.split("?");return n+"/"+(o.length>0?`?${o.join("?")}`:"")}function er(e,t){if(nr(t)||On(e))return e;const n=xo(t);return e.startsWith(n)?e:sr(n,e)}function tr(e,t){const n=Bn(e),o={...Go(n.search),...t};return n.search=Ko(o),ir(n)}function nr(e){return!e||e==="/"}function or(e){return e&&e!=="/"}const rr=/^\.?\//;function sr(e,...t){let n=e||"";for(const o of t.filter(r=>or(r)))if(n){const r=o.replace(rr,"");n=$o(n)+r}else n=o;return n}function Bn(e="",t){const n=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/);if(n){const[,_,g=""]=n;return{protocol:_,pathname:g,href:_+g,auth:"",host:"",search:"",hash:""}}if(!On(e,{acceptRelative:!0}))return t?Bn(t+e):Bt(e);const[,o="",r,s=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,i="",a=""]=s.match(/([^#/?]*)(.*)?/)||[],{pathname:l,search:u,hash:c}=Bt(a.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:o,auth:r?r.slice(0,Math.max(0,r.length-1)):"",host:i,pathname:l,search:u,hash:c}}function Bt(e=""){const[t="",n="",o=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:n,hash:o}}function ir(e){const t=e.pathname||"",n=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",o=e.hash||"",r=e.auth?e.auth+"@":"",s=e.host||"";return(e.protocol?e.protocol+"//":"")+r+s+t+n+o}class ar extends Error{constructor(t,n){super(t,n),this.name="FetchError",n!=null&&n.cause&&!this.cause&&(this.cause=n.cause)}}function lr(e){var t,n,o,r,s;const i=((t=e.error)==null?void 0:t.message)||((n=e.error)==null?void 0:n.toString())||"",a=((o=e.request)==null?void 0:o.method)||((r=e.options)==null?void 0:r.method)||"GET",l=((s=e.request)==null?void 0:s.url)||String(e.request)||"/",u=`[${a}] ${JSON.stringify(l)}`,c=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",_=`${u}: ${c}${i?` ${i}`:""}`,g=new ar(_,e.error?{cause:e.error}:void 0);for(const d of["request","options","response"])Object.defineProperty(g,d,{get(){return e[d]}});for(const[d,b]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(g,d,{get(){return e.response&&e.response[b]}});return g}const cr=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function Ct(e="GET"){return cr.has(e.toUpperCase())}function ur(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const fr=new Set(["image/svg","application/xml","application/xhtml","application/html"]),dr=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function pr(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return dr.test(t)?"json":fr.has(t)||t.startsWith("text/")?"text":"blob"}function hr(e,t,n=globalThis.Headers){const o={...t,...e};if(t!=null&&t.params&&e!=null&&e.params&&(o.params={...t==null?void 0:t.params,...e==null?void 0:e.params}),t!=null&&t.query&&e!=null&&e.query&&(o.query={...t==null?void 0:t.query,...e==null?void 0:e.query}),t!=null&&t.headers&&e!=null&&e.headers){o.headers=new n((t==null?void 0:t.headers)||{});for(const[r,s]of new n((e==null?void 0:e.headers)||{}))o.headers.set(r,s)}return o}const mr=new Set([408,409,425,429,500,502,503,504]),br=new Set([101,204,205,304]);function Cn(e={}){const{fetch:t=globalThis.fetch,Headers:n=globalThis.Headers,AbortController:o=globalThis.AbortController}=e;async function r(a){const l=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!l){let c;typeof a.options.retry=="number"?c=a.options.retry:c=Ct(a.options.method)?0:1;const _=a.response&&a.response.status||500;if(c>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(_):mr.has(_))){const g=a.options.retryDelay||0;return g>0&&await new Promise(d=>setTimeout(d,g)),s(a.request,{...a.options,retry:c-1,timeout:a.options.timeout})}}const u=lr(a);throw Error.captureStackTrace&&Error.captureStackTrace(u,s),u}const s=async function(a,l={}){var u;const c={request:a,options:hr(l,e.defaults,n),response:void 0,error:void 0};if(c.options.method=(u=c.options.method)==null?void 0:u.toUpperCase(),c.options.onRequest&&await c.options.onRequest(c),typeof c.request=="string"&&(c.options.baseURL&&(c.request=er(c.request,c.options.baseURL)),(c.options.query||c.options.params)&&(c.request=tr(c.request,{...c.options.params,...c.options.query}))),c.options.body&&Ct(c.options.method)&&(ur(c.options.body)?(c.options.body=typeof c.options.body=="string"?c.options.body:JSON.stringify(c.options.body),c.options.headers=new n(c.options.headers||{}),c.options.headers.has("content-type")||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json")):("pipeTo"in c.options.body&&typeof c.options.body.pipeTo=="function"||typeof c.options.body.pipe=="function")&&("duplex"in c.options||(c.options.duplex="half"))),!c.options.signal&&c.options.timeout){const _=new o;setTimeout(()=>_.abort(),c.options.timeout),c.options.signal=_.signal}try{c.response=await t(c.request,c.options)}catch(_){return c.error=_,c.options.onRequestError&&await c.options.onRequestError(c),await r(c)}if(c.response.body&&!br.has(c.response.status)&&c.options.method!=="HEAD"){const _=(c.options.parseResponse?"json":c.options.responseType)||pr(c.response.headers.get("content-type")||"");switch(_){case"json":{const g=await c.response.text(),d=c.options.parseResponse||Mo;c.response._data=d(g);break}case"stream":{c.response._data=c.response.body;break}default:c.response._data=await c.response[_]()}}return c.options.onResponse&&await c.options.onResponse(c),!c.options.ignoreResponseError&&c.response.status>=400&&c.response.status<600?(c.options.onResponseError&&await c.options.onResponseError(c),await r(c)):c.response},i=async function(a,l){return(await s(a,l))._data};return i.raw=s,i.native=(...a)=>t(...a),i.create=(a={})=>Cn({...e,defaults:{...e.defaults,...a}}),i}const yt=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),gr=yt.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),_r=yt.Headers,yr=yt.AbortController,kr=Cn({fetch:gr,Headers:_r,AbortController:yr});class wr extends Error{constructor(t){super(t.statusText),se(this,"status"),this.response=t,this.status=t.status}}class Dt extends Error{constructor(t,n){super(t.msg),se(this,"code"),this.body=t,this.response=n,this.code=t.code}}function ne(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Rt(e,t){for(var n="",o=0,r=-1,s=0,i,a=0;a<=e.length;++a){if(a<e.length)i=e.charCodeAt(a);else{if(i===47)break;i=47}if(i===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var l=n.lastIndexOf("/");if(l!==n.length-1){l===-1?(n="",o=0):(n=n.slice(0,l),o=n.length-1-n.lastIndexOf("/")),r=a,s=0;continue}}else if(n.length===2||n.length===1){n="",o=0,r=a,s=0;continue}}t&&(n.length>0?n+="/..":n="..",o=2)}else n.length>0?n+="/"+e.slice(r+1,a):n=e.slice(r+1,a),o=a-r-1;r=a,s=0}else i===46&&s!==-1?++s:s=-1}return n}function Sr(e,t){var n=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+o:n+e+o:o}var Be={resolve:function(){for(var e="",t=!1,n,o=arguments.length-1;o>=-1&&!t;o--){var r;o>=0?r=arguments[o]:(n===void 0&&(n=process.cwd()),r=n),ne(r),r.length!==0&&(e=r+"/"+e,t=r.charCodeAt(0)===47)}return e=Rt(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(ne(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Rt(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return ne(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];ne(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":Be.normalize(e)},relative:function(e,t){if(ne(e),ne(t),e===t||(e=Be.resolve(e),t=Be.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var o=e.length,r=o-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var i=t.length,a=i-s,l=r<a?r:a,u=-1,c=0;c<=l;++c){if(c===l){if(a>l){if(t.charCodeAt(s+c)===47)return t.slice(s+c+1);if(c===0)return t.slice(s+c)}else r>l&&(e.charCodeAt(n+c)===47?u=c:c===0&&(u=0));break}var _=e.charCodeAt(n+c),g=t.charCodeAt(s+c);if(_!==g)break;_===47&&(u=c)}var d="";for(c=n+u+1;c<=o;++c)(c===o||e.charCodeAt(c)===47)&&(d.length===0?d+="..":d+="/..");return d.length>0?d+t.slice(s+u):(s+=u,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(ne(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,o=-1,r=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!r){o=s;break}}else r=!1;return o===-1?n?"/":".":n&&o===1?"//":e.slice(0,o)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');ne(e);var n=0,o=-1,r=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var i=t.length-1,a=-1;for(s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(l===47){if(!r){n=s+1;break}}else a===-1&&(r=!1,a=s+1),i>=0&&(l===t.charCodeAt(i)?--i===-1&&(o=s):(i=-1,o=a))}return n===o?o=a:o===-1&&(o=e.length),e.slice(n,o)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!r){n=s+1;break}}else o===-1&&(r=!1,o=s+1);return o===-1?"":e.slice(n,o)}},extname:function(e){ne(e);for(var t=-1,n=0,o=-1,r=!0,s=0,i=e.length-1;i>=0;--i){var a=e.charCodeAt(i);if(a===47){if(!r){n=i+1;break}continue}o===-1&&(r=!1,o=i+1),a===46?t===-1?t=i:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||o===-1||s===0||s===1&&t===o-1&&t===n+1?"":e.slice(t,o)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Sr("/",e)},parse:function(e){ne(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),o=n===47,r;o?(t.root="/",r=1):r=0;for(var s=-1,i=0,a=-1,l=!0,u=e.length-1,c=0;u>=r;--u){if(n=e.charCodeAt(u),n===47){if(!l){i=u+1;break}continue}a===-1&&(l=!1,a=u+1),n===46?s===-1?s=u:c!==1&&(c=1):s!==-1&&(c=-1)}return s===-1||a===-1||c===0||c===1&&s===a-1&&s===i+1?a!==-1&&(i===0&&o?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(i,a)):(i===0&&o?(t.name=e.slice(1,s),t.base=e.slice(1,a)):(t.name=e.slice(i,s),t.base=e.slice(i,a)),t.ext=e.slice(s,a)),i>0?t.dir=e.slice(0,i-1):o&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Be.posix=Be;function Dn(e,t){return function(){return e.apply(t,arguments)}}const{toString:Nr}=Object.prototype,{getPrototypeOf:kt}=Object,Ke=(e=>t=>{const n=Nr.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),re=e=>(e=e.toLowerCase(),t=>Ke(t)===e),Qe=e=>t=>typeof t===e,{isArray:Ae}=Array,De=Qe("undefined");function vr(e){return e!==null&&!De(e)&&e.constructor!==null&&!De(e.constructor)&&K(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Rn=re("ArrayBuffer");function Er(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Rn(e.buffer),t}const Tr=Qe("string"),K=Qe("function"),Pn=Qe("number"),Ye=e=>e!==null&&typeof e=="object",Ar=e=>e===!0||e===!1,Ie=e=>{if(Ke(e)!=="object")return!1;const t=kt(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Or=re("Date"),Br=re("File"),Cr=re("Blob"),Dr=re("FileList"),Rr=e=>Ye(e)&&K(e.pipe),Pr=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||K(e.append)&&((t=Ke(e))==="formdata"||t==="object"&&K(e.toString)&&e.toString()==="[object FormData]"))},Mr=re("URLSearchParams"),qr=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function qe(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let o,r;if(typeof e!="object"&&(e=[e]),Ae(e))for(o=0,r=e.length;o<r;o++)t.call(null,e[o],o,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let a;for(o=0;o<i;o++)a=s[o],t.call(null,e[a],a,e)}}function Mn(e,t){t=t.toLowerCase();const n=Object.keys(e);let o=n.length,r;for(;o-- >0;)if(r=n[o],t===r.toLowerCase())return r;return null}const qn=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Fn=e=>!De(e)&&e!==qn;function ut(){const{caseless:e}=Fn(this)&&this||{},t={},n=(o,r)=>{const s=e&&Mn(t,r)||r;Ie(t[s])&&Ie(o)?t[s]=ut(t[s],o):Ie(o)?t[s]=ut({},o):Ae(o)?t[s]=o.slice():t[s]=o};for(let o=0,r=arguments.length;o<r;o++)arguments[o]&&qe(arguments[o],n);return t}const Fr=(e,t,n,{allOwnKeys:o}={})=>(qe(t,(r,s)=>{n&&K(r)?e[s]=Dn(r,n):e[s]=r},{allOwnKeys:o}),e),Lr=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),jr=(e,t,n,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Ir=(e,t,n,o)=>{let r,s,i;const a={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),s=r.length;s-- >0;)i=r[s],(!o||o(i,e,t))&&!a[i]&&(t[i]=e[i],a[i]=!0);e=n!==!1&&kt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Ur=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const o=e.indexOf(t,n);return o!==-1&&o===n},zr=e=>{if(!e)return null;if(Ae(e))return e;let t=e.length;if(!Pn(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Hr=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&kt(Uint8Array)),Wr=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=n.next())&&!o.done;){const r=o.value;t.call(e,r[0],r[1])}},Vr=(e,t)=>{let n;const o=[];for(;(n=e.exec(t))!==null;)o.push(n);return o},Gr=re("HTMLFormElement"),Jr=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,o){return n.toUpperCase()+o}),Pt=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Kr=re("RegExp"),Ln=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),o={};qe(n,(r,s)=>{let i;(i=t(r,s,e))!==!1&&(o[s]=i||r)}),Object.defineProperties(e,o)},Qr=e=>{Ln(e,(t,n)=>{if(K(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=e[n];if(K(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Yr=(e,t)=>{const n={},o=r=>{r.forEach(s=>{n[s]=!0})};return Ae(e)?o(e):o(String(e).split(t)),n},Zr=()=>{},Xr=(e,t)=>(e=+e,Number.isFinite(e)?e:t),tt="abcdefghijklmnopqrstuvwxyz",Mt="0123456789",jn={DIGIT:Mt,ALPHA:tt,ALPHA_DIGIT:tt+tt.toUpperCase()+Mt},xr=(e=16,t=jn.ALPHA_DIGIT)=>{let n="";const{length:o}=t;for(;e--;)n+=t[Math.random()*o|0];return n};function $r(e){return!!(e&&K(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const es=e=>{const t=new Array(10),n=(o,r)=>{if(Ye(o)){if(t.indexOf(o)>=0)return;if(!("toJSON"in o)){t[r]=o;const s=Ae(o)?[]:{};return qe(o,(i,a)=>{const l=n(i,r+1);!De(l)&&(s[a]=l)}),t[r]=void 0,s}}return o};return n(e,0)},ts=re("AsyncFunction"),ns=e=>e&&(Ye(e)||K(e))&&K(e.then)&&K(e.catch),h={isArray:Ae,isArrayBuffer:Rn,isBuffer:vr,isFormData:Pr,isArrayBufferView:Er,isString:Tr,isNumber:Pn,isBoolean:Ar,isObject:Ye,isPlainObject:Ie,isUndefined:De,isDate:Or,isFile:Br,isBlob:Cr,isRegExp:Kr,isFunction:K,isStream:Rr,isURLSearchParams:Mr,isTypedArray:Hr,isFileList:Dr,forEach:qe,merge:ut,extend:Fr,trim:qr,stripBOM:Lr,inherits:jr,toFlatObject:Ir,kindOf:Ke,kindOfTest:re,endsWith:Ur,toArray:zr,forEachEntry:Wr,matchAll:Vr,isHTMLForm:Gr,hasOwnProperty:Pt,hasOwnProp:Pt,reduceDescriptors:Ln,freezeMethods:Qr,toObjectSet:Yr,toCamelCase:Jr,noop:Zr,toFiniteNumber:Xr,findKey:Mn,global:qn,isContextDefined:Fn,ALPHABET:jn,generateString:xr,isSpecCompliantForm:$r,toJSONObject:es,isAsyncFn:ts,isThenable:ns};function B(e,t,n,o,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),r&&(this.response=r)}h.inherits(B,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:h.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const In=B.prototype,Un={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Un[e]={value:e}});Object.defineProperties(B,Un);Object.defineProperty(In,"isAxiosError",{value:!0});B.from=(e,t,n,o,r,s)=>{const i=Object.create(In);return h.toFlatObject(e,i,function(a){return a!==Error.prototype},a=>a!=="isAxiosError"),B.call(i,e.message,t,n,o,r),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const os=null;function ft(e){return h.isPlainObject(e)||h.isArray(e)}function zn(e){return h.endsWith(e,"[]")?e.slice(0,-2):e}function qt(e,t,n){return e?e.concat(t).map(function(o,r){return o=zn(o),!n&&r?"["+o+"]":o}).join(n?".":""):t}function rs(e){return h.isArray(e)&&!e.some(ft)}const ss=h.toFlatObject(h,{},null,function(e){return/^is[A-Z]/.test(e)});function Ze(e,t,n){if(!h.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=h.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(d,b){return!h.isUndefined(b[d])});const o=n.metaTokens,r=n.visitor||u,s=n.dots,i=n.indexes,a=(n.Blob||typeof Blob<"u"&&Blob)&&h.isSpecCompliantForm(t);if(!h.isFunction(r))throw new TypeError("visitor must be a function");function l(d){if(d===null)return"";if(h.isDate(d))return d.toISOString();if(!a&&h.isBlob(d))throw new B("Blob is not supported. Use a Buffer instead.");return h.isArrayBuffer(d)||h.isTypedArray(d)?a&&typeof Blob=="function"?new Blob([d]):Buffer.from(d):d}function u(d,b,m){let f=d;if(d&&!m&&typeof d=="object"){if(h.endsWith(b,"{}"))b=o?b:b.slice(0,-2),d=JSON.stringify(d);else if(h.isArray(d)&&rs(d)||(h.isFileList(d)||h.endsWith(b,"[]"))&&(f=h.toArray(d)))return b=zn(b),f.forEach(function(y,M){!(h.isUndefined(y)||y===null)&&t.append(i===!0?qt([b],M,s):i===null?b:b+"[]",l(y))}),!1}return ft(d)?!0:(t.append(qt(m,b,s),l(d)),!1)}const c=[],_=Object.assign(ss,{defaultVisitor:u,convertValue:l,isVisitable:ft});function g(d,b){if(!h.isUndefined(d)){if(c.indexOf(d)!==-1)throw Error("Circular reference detected in "+b.join("."));c.push(d),h.forEach(d,function(m,f){(!(h.isUndefined(m)||m===null)&&r.call(t,m,h.isString(f)?f.trim():f,b,_))===!0&&g(m,b?b.concat(f):[f])}),c.pop()}}if(!h.isObject(e))throw new TypeError("data must be an object");return g(e),t}function Ft(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function wt(e,t){this._pairs=[],e&&Ze(e,this,t)}const Hn=wt.prototype;Hn.append=function(e,t){this._pairs.push([e,t])};Hn.toString=function(e){const t=e?function(n){return e.call(this,n,Ft)}:Ft;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function is(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Wn(e,t,n){if(!t)return e;const o=n&&n.encode||is,r=n&&n.serialize;let s;if(r?s=r(t,n):s=h.isURLSearchParams(t)?t.toString():new wt(t,n).toString(o),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class as{constructor(){this.handlers=[]}use(t,n,o){return this.handlers.push({fulfilled:t,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){h.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Lt=as,Vn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ls=typeof URLSearchParams<"u"?URLSearchParams:wt,cs=typeof FormData<"u"?FormData:null,us=typeof Blob<"u"?Blob:null,fs=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),ds=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),X={isBrowser:!0,classes:{URLSearchParams:ls,FormData:cs,Blob:us},isStandardBrowserEnv:fs,isStandardBrowserWebWorkerEnv:ds,protocols:["http","https","file","blob","url","data"]};function ps(e,t){return Ze(e,new X.classes.URLSearchParams,Object.assign({visitor:function(n,o,r,s){return X.isNode&&h.isBuffer(n)?(this.append(o,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function hs(e){return h.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ms(e){const t={},n=Object.keys(e);let o;const r=n.length;let s;for(o=0;o<r;o++)s=n[o],t[s]=e[s];return t}function Gn(e){function t(n,o,r,s){let i=n[s++];const a=Number.isFinite(+i),l=s>=n.length;return i=!i&&h.isArray(r)?r.length:i,l?(h.hasOwnProp(r,i)?r[i]=[r[i],o]:r[i]=o,!a):((!r[i]||!h.isObject(r[i]))&&(r[i]=[]),t(n,o,r[i],s)&&h.isArray(r[i])&&(r[i]=ms(r[i])),!a)}if(h.isFormData(e)&&h.isFunction(e.entries)){const n={};return h.forEachEntry(e,(o,r)=>{t(hs(o),r,n,0)}),n}return null}function bs(e,t,n){if(h.isString(e))try{return(t||JSON.parse)(e),h.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(e)}const St={transitional:Vn,adapter:X.isNode?"http":"xhr",transformRequest:[function(e,t){const n=t.getContentType()||"",o=n.indexOf("application/json")>-1,r=h.isObject(e);if(r&&h.isHTMLForm(e)&&(e=new FormData(e)),h.isFormData(e))return o&&o?JSON.stringify(Gn(e)):e;if(h.isArrayBuffer(e)||h.isBuffer(e)||h.isStream(e)||h.isFile(e)||h.isBlob(e))return e;if(h.isArrayBufferView(e))return e.buffer;if(h.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return ps(e,this.formSerializer).toString();if((s=h.isFileList(e))||n.indexOf("multipart/form-data")>-1){const i=this.env&&this.env.FormData;return Ze(s?{"files[]":e}:e,i&&new i,this.formSerializer)}}return r||o?(t.setContentType("application/json",!1),bs(e)):e}],transformResponse:[function(e){const t=this.transitional||St.transitional,n=t&&t.forcedJSONParsing,o=this.responseType==="json";if(e&&h.isString(e)&&(n&&!this.responseType||o)){const r=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(s){if(r)throw s.name==="SyntaxError"?B.from(s,B.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:X.classes.FormData,Blob:X.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};h.forEach(["delete","get","head","post","put","patch"],e=>{St.headers[e]={}});const Nt=St,gs=h.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_s=e=>{const t={};let n,o,r;return e&&e.split(`
`).forEach(function(s){r=s.indexOf(":"),n=s.substring(0,r).trim().toLowerCase(),o=s.substring(r+1).trim(),!(!n||t[n]&&gs[n])&&(n==="set-cookie"?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)}),t},jt=Symbol("internals");function Oe(e){return e&&String(e).trim().toLowerCase()}function Ue(e){return e===!1||e==null?e:h.isArray(e)?e.map(Ue):String(e)}function ys(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)t[o[1]]=o[2];return t}const ks=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function nt(e,t,n,o,r){if(h.isFunction(o))return o.call(this,t,n);if(r&&(t=n),!!h.isString(t)){if(h.isString(o))return t.indexOf(o)!==-1;if(h.isRegExp(o))return o.test(t)}}function ws(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,o)=>n.toUpperCase()+o)}function Ss(e,t){const n=h.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+n,{value:function(r,s,i){return this[o].call(this,t,r,s,i)},configurable:!0})})}let Xe=class{constructor(e){e&&this.set(e)}set(e,t,n){const o=this;function r(i,a,l){const u=Oe(a);if(!u)throw new Error("header name must be a non-empty string");const c=h.findKey(o,u);(!c||o[c]===void 0||l===!0||l===void 0&&o[c]!==!1)&&(o[c||a]=Ue(i))}const s=(i,a)=>h.forEach(i,(l,u)=>r(l,u,a));return h.isPlainObject(e)||e instanceof this.constructor?s(e,t):h.isString(e)&&(e=e.trim())&&!ks(e)?s(_s(e),t):e!=null&&r(t,e,n),this}get(e,t){if(e=Oe(e),e){const n=h.findKey(this,e);if(n){const o=this[n];if(!t)return o;if(t===!0)return ys(o);if(h.isFunction(t))return t.call(this,o,n);if(h.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Oe(e),e){const n=h.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||nt(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let o=!1;function r(s){if(s=Oe(s),s){const i=h.findKey(n,s);i&&(!t||nt(n,n[i],i,t))&&(delete n[i],o=!0)}}return h.isArray(e)?e.forEach(r):r(e),o}clear(e){const t=Object.keys(this);let n=t.length,o=!1;for(;n--;){const r=t[n];(!e||nt(this,this[r],r,e,!0))&&(delete this[r],o=!0)}return o}normalize(e){const t=this,n={};return h.forEach(this,(o,r)=>{const s=h.findKey(n,r);if(s){t[s]=Ue(o),delete t[r];return}const i=e?ws(r):String(r).trim();i!==r&&delete t[r],t[i]=Ue(o),n[i]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return h.forEach(this,(n,o)=>{n!=null&&n!==!1&&(t[o]=e&&h.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(o=>n.set(o)),n}static accessor(e){const t=(this[jt]=this[jt]={accessors:{}}).accessors,n=this.prototype;function o(r){const s=Oe(r);t[s]||(Ss(n,r),t[s]=!0)}return h.isArray(e)?e.forEach(o):o(e),this}};Xe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);h.reduceDescriptors(Xe.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(o){this[n]=o}}});h.freezeMethods(Xe);const ie=Xe;function ot(e,t){const n=this||Nt,o=t||n,r=ie.from(o.headers);let s=o.data;return h.forEach(e,function(i){s=i.call(n,s,r.normalize(),t?t.status:void 0)}),r.normalize(),s}function Jn(e){return!!(e&&e.__CANCEL__)}function Fe(e,t,n){B.call(this,e??"canceled",B.ERR_CANCELED,t,n),this.name="CanceledError"}h.inherits(Fe,B,{__CANCEL__:!0});function Ns(e,t,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?e(n):t(new B("Request failed with status code "+n.status,[B.ERR_BAD_REQUEST,B.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const vs=X.isStandardBrowserEnv?function(){return{write:function(e,t,n,o,r,s){const i=[];i.push(e+"="+encodeURIComponent(t)),h.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),h.isString(o)&&i.push("path="+o),h.isString(r)&&i.push("domain="+r),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function Es(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Ts(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function Kn(e,t){return e&&!Es(t)?Ts(e,t):t}const As=X.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function o(r){let s=r;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=o(window.location.href),function(r){const s=h.isString(r)?o(r):r;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}();function Os(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Bs(e,t){e=e||10;const n=new Array(e),o=new Array(e);let r=0,s=0,i;return t=t!==void 0?t:1e3,function(a){const l=Date.now(),u=o[s];i||(i=l),n[r]=a,o[r]=l;let c=s,_=0;for(;c!==r;)_+=n[c++],c=c%e;if(r=(r+1)%e,r===s&&(s=(s+1)%e),l-i<t)return;const g=u&&l-u;return g?Math.round(_*1e3/g):void 0}}function It(e,t){let n=0;const o=Bs(50,250);return r=>{const s=r.loaded,i=r.lengthComputable?r.total:void 0,a=s-n,l=o(a),u=s<=i;n=s;const c={loaded:s,total:i,progress:i?s/i:void 0,bytes:a,rate:l||void 0,estimated:l&&i&&u?(i-s)/l:void 0,event:r};c[t?"download":"upload"]=!0,e(c)}}const Cs=typeof XMLHttpRequest<"u",Ds=Cs&&function(e){return new Promise(function(t,n){let o=e.data;const r=ie.from(e.headers).normalize(),s=e.responseType;let i;function a(){e.cancelToken&&e.cancelToken.unsubscribe(i),e.signal&&e.signal.removeEventListener("abort",i)}h.isFormData(o)&&(X.isStandardBrowserEnv||X.isStandardBrowserWebWorkerEnv?r.setContentType(!1):r.setContentType("multipart/form-data;",!1));let l=new XMLHttpRequest;if(e.auth){const g=e.auth.username||"",d=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";r.set("Authorization","Basic "+btoa(g+":"+d))}const u=Kn(e.baseURL,e.url);l.open(e.method.toUpperCase(),Wn(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout;function c(){if(!l)return;const g=ie.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),d={data:!s||s==="text"||s==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:g,config:e,request:l};Ns(function(b){t(b),a()},function(b){n(b),a()},d),l=null}if("onloadend"in l?l.onloadend=c:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(c)},l.onabort=function(){l&&(n(new B("Request aborted",B.ECONNABORTED,e,l)),l=null)},l.onerror=function(){n(new B("Network Error",B.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let g=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const d=e.transitional||Vn;e.timeoutErrorMessage&&(g=e.timeoutErrorMessage),n(new B(g,d.clarifyTimeoutError?B.ETIMEDOUT:B.ECONNABORTED,e,l)),l=null},X.isStandardBrowserEnv){const g=(e.withCredentials||As(u))&&e.xsrfCookieName&&vs.read(e.xsrfCookieName);g&&r.set(e.xsrfHeaderName,g)}o===void 0&&r.setContentType(null),"setRequestHeader"in l&&h.forEach(r.toJSON(),function(g,d){l.setRequestHeader(d,g)}),h.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),s&&s!=="json"&&(l.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&l.addEventListener("progress",It(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",It(e.onUploadProgress)),(e.cancelToken||e.signal)&&(i=g=>{l&&(n(!g||g.type?new Fe(null,e,l):g),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(i),e.signal&&(e.signal.aborted?i():e.signal.addEventListener("abort",i)));const _=Os(u);if(_&&X.protocols.indexOf(_)===-1){n(new B("Unsupported protocol "+_+":",B.ERR_BAD_REQUEST,e));return}l.send(o||null)})},ze={http:os,xhr:Ds};h.forEach(ze,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Qn={getAdapter:e=>{e=h.isArray(e)?e:[e];const{length:t}=e;let n,o;for(let r=0;r<t&&(n=e[r],!(o=h.isString(n)?ze[n.toLowerCase()]:n));r++);if(!o)throw o===!1?new B(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(h.hasOwnProp(ze,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`);if(!h.isFunction(o))throw new TypeError("adapter is not a function");return o},adapters:ze};function rt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Fe(null,e)}function Ut(e){return rt(e),e.headers=ie.from(e.headers),e.data=ot.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Qn.getAdapter(e.adapter||Nt.adapter)(e).then(function(t){return rt(e),t.data=ot.call(e,e.transformResponse,t),t.headers=ie.from(t.headers),t},function(t){return Jn(t)||(rt(e),t&&t.response&&(t.response.data=ot.call(e,e.transformResponse,t.response),t.response.headers=ie.from(t.response.headers))),Promise.reject(t)})}const zt=e=>e instanceof ie?e.toJSON():e;function Ee(e,t){t=t||{};const n={};function o(u,c,_){return h.isPlainObject(u)&&h.isPlainObject(c)?h.merge.call({caseless:_},u,c):h.isPlainObject(c)?h.merge({},c):h.isArray(c)?c.slice():c}function r(u,c,_){if(h.isUndefined(c)){if(!h.isUndefined(u))return o(void 0,u,_)}else return o(u,c,_)}function s(u,c){if(!h.isUndefined(c))return o(void 0,c)}function i(u,c){if(h.isUndefined(c)){if(!h.isUndefined(u))return o(void 0,u)}else return o(void 0,c)}function a(u,c,_){if(_ in t)return o(u,c);if(_ in e)return o(void 0,u)}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(u,c)=>r(zt(u),zt(c),!0)};return h.forEach(Object.keys(Object.assign({},e,t)),function(u){const c=l[u]||r,_=c(e[u],t[u],u);h.isUndefined(_)&&c!==a||(n[u]=_)}),n}const Yn="1.5.0",vt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{vt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ht={};vt.transitional=function(e,t,n){function o(r,s){return"[Axios v"+Yn+"] Transitional option '"+r+"'"+s+(n?". "+n:"")}return(r,s,i)=>{if(e===!1)throw new B(o(s," has been removed"+(t?" in "+t:"")),B.ERR_DEPRECATED);return t&&!Ht[s]&&(Ht[s]=!0,console.warn(o(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,s,i):!0}};function Rs(e,t,n){if(typeof e!="object")throw new B("options must be an object",B.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let r=o.length;for(;r-- >0;){const s=o[r],i=t[s];if(i){const a=e[s],l=a===void 0||i(a,s,e);if(l!==!0)throw new B("option "+s+" must be "+l,B.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new B("Unknown option "+s,B.ERR_BAD_OPTION)}}const dt={assertOptions:Rs,validators:vt},ue=dt.validators;let Ve=class{constructor(e){this.defaults=e,this.interceptors={request:new Lt,response:new Lt}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ee(this.defaults,t);const{transitional:n,paramsSerializer:o,headers:r}=t;n!==void 0&&dt.assertOptions(n,{silentJSONParsing:ue.transitional(ue.boolean),forcedJSONParsing:ue.transitional(ue.boolean),clarifyTimeoutError:ue.transitional(ue.boolean)},!1),o!=null&&(h.isFunction(o)?t.paramsSerializer={serialize:o}:dt.assertOptions(o,{encode:ue.function,serialize:ue.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&h.merge(r.common,r[t.method]);r&&h.forEach(["delete","get","head","post","put","patch","common"],d=>{delete r[d]}),t.headers=ie.concat(s,r);const i=[];let a=!0;this.interceptors.request.forEach(function(d){typeof d.runWhen=="function"&&d.runWhen(t)===!1||(a=a&&d.synchronous,i.unshift(d.fulfilled,d.rejected))});const l=[];this.interceptors.response.forEach(function(d){l.push(d.fulfilled,d.rejected)});let u,c=0,_;if(!a){const d=[Ut.bind(this),void 0];for(d.unshift.apply(d,i),d.push.apply(d,l),_=d.length,u=Promise.resolve(t);c<_;)u=u.then(d[c++],d[c++]);return u}_=i.length;let g=t;for(c=0;c<_;){const d=i[c++],b=i[c++];try{g=d(g)}catch(m){b.call(this,m);break}}try{u=Ut.call(this,g)}catch(d){return Promise.reject(d)}for(c=0,_=l.length;c<_;)u=u.then(l[c++],l[c++]);return u}getUri(e){e=Ee(this.defaults,e);const t=Kn(e.baseURL,e.url);return Wn(t,e.params,e.paramsSerializer)}};h.forEach(["delete","get","head","options"],function(e){Ve.prototype[e]=function(t,n){return this.request(Ee(n||{},{method:e,url:t,data:(n||{}).data}))}});h.forEach(["post","put","patch"],function(e){function t(n){return function(o,r,s){return this.request(Ee(s||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}Ve.prototype[e]=t(),Ve.prototype[e+"Form"]=t(!0)});const He=Ve;let Ps=class Zn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(r){n=r});const o=this;this.promise.then(r=>{if(!o._listeners)return;let s=o._listeners.length;for(;s-- >0;)o._listeners[s](r);o._listeners=null}),this.promise.then=r=>{let s;const i=new Promise(a=>{o.subscribe(a),s=a}).then(r);return i.cancel=function(){o.unsubscribe(s)},i},t(function(r,s,i){o.reason||(o.reason=new Fe(r,s,i),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Zn(function(n){t=n}),cancel:t}}};const Ms=Ps;function qs(e){return function(t){return e.apply(null,t)}}function Fs(e){return h.isObject(e)&&e.isAxiosError===!0}const pt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(pt).forEach(([e,t])=>{pt[t]=e});const Ls=pt;function Xn(e){const t=new He(e),n=Dn(He.prototype.request,t);return h.extend(n,He.prototype,t,{allOwnKeys:!0}),h.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Xn(Ee(e,o))},n}const j=Xn(Nt);j.Axios=He;j.CanceledError=Fe;j.CancelToken=Ms;j.isCancel=Jn;j.VERSION=Yn;j.toFormData=Ze;j.AxiosError=B;j.Cancel=j.CanceledError;j.all=function(e){return Promise.all(e)};j.spread=qs;j.isAxiosError=Fs;j.mergeConfig=Ee;j.AxiosHeaders=ie;j.formToJSON=e=>Gn(h.isHTMLForm(e)?new FormData(e):e);j.getAdapter=Qn.getAdapter;j.HttpStatusCode=Ls;j.default=j;const xn=j,{Axios:Ca,AxiosError:Da,CanceledError:Ra,isCancel:Pa,CancelToken:Ma,VERSION:qa,all:Fa,Cancel:La,isAxiosError:ja,spread:Ia,toFormData:Ua,AxiosHeaders:za,HttpStatusCode:Le,formToJSON:Ha,getAdapter:Wa,mergeConfig:Va}=xn;var Se=null;typeof WebSocket<"u"?Se=WebSocket:typeof MozWebSocket<"u"?Se=MozWebSocket:typeof global<"u"?Se=global.WebSocket||global.MozWebSocket:typeof window<"u"?Se=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Se=self.WebSocket||self.MozWebSocket);const js=Se,st={SCHEMA_DIR_RELATIVE_PATH:"./../schemas/",SCHEMA_FILENAME_PAYLOAD:"payload.schema.json",SCHEMA_FILENAME_RESPONSE:"response.schema.json",SIYUAN_DEFAULT_BASE_URL:"http://localhost:6806/",SIYUAN_DEFAULT_TOKEN:"",REQUEST_TIMEOUT:6e4};var Wt,Vt,Gt,Jt,Kt;const ht=class p{constructor(t={},n="xhr"){se(this,"_type","xhr"),se(this,"_baseURL",((Vt=(Wt=globalThis.top)==null?void 0:Wt.document)==null?void 0:Vt.baseURI)??((Jt=(Gt=globalThis.parent)==null?void 0:Gt.document)==null?void 0:Jt.baseURI)??((Kt=globalThis.location)==null?void 0:Kt.origin)??st.SIYUAN_DEFAULT_BASE_URL),se(this,"_token",st.SIYUAN_DEFAULT_TOKEN),se(this,"_axios",xn.create({baseURL:this._baseURL,timeout:st.REQUEST_TIMEOUT,headers:{Authorization:`Token ${this._token}`}})),se(this,"_fetch",kr.create({baseURL:this._baseURL,headers:{Authorization:`Token ${this._token}`}})),this._setClientType(n),this._updateOptions(t,n)}_setClientType(t){this._type=t}_updateOptions(t,n=this._type){switch(this._token=t.token??this._token,this._baseURL=t.baseURL??this._baseURL,n){case"fetch":const o=t;if(o.token){const r="Authorization",s=`Token ${t.token}`;Array.isArray(o.headers)?o.headers.push([r,s]):o.headers instanceof Headers?o.headers.set(r,s):typeof o.headers=="object"?o.headers[r]=s:o.headers={[r]:s},delete t.token}this._fetch=this._fetch.create(o);break;case"xhr":default:for(const[r,s]of Object.entries(t))switch(r){case"token":this._axios.defaults.headers.Authorization=`Token ${this._token}`;break;default:this._axios.defaults[r]=s;break}break}this._baseURL=t.baseURL??this._baseURL}broadcast(t,n,o){const r=(o==null?void 0:o.baseURL)??this._baseURL,s=(o==null?void 0:o.token)??this._token,i=new URLSearchParams(t);i.set("token",s);const a=new URL(r);return a.protocol=a.protocol.replace(/^http/,"ws"),a.pathname=a.pathname.endsWith("/")?`${a.pathname}${p.ws.broadcast.pathname.substring(1)}`:`${a.pathname}${p.ws.broadcast.pathname}`,a.search=i.toString(),new js(a,n)}async fullTextSearchBlock(t,n){return await this._request(p.api.search.fullTextSearchBlock.pathname,p.api.search.fullTextSearchBlock.method,t,n)}async getConf(t){return await this._request(p.api.system.getConf.pathname,p.api.system.getConf.method,void 0,t)}async upload(t,n){const o=new FormData;return o.append("assetsDirPath",t.assetsDirPath??"/assets/"),t.files.forEach(r=>o.append("file[]",r)),await this._request(p.api.asset.upload.pathname,p.api.asset.upload.method,o,n)}async getBlockAttrs(t,n){return await this._request(p.api.attr.getBlockAttrs.pathname,p.api.attr.getBlockAttrs.method,t,n)}async getBookmarkLabels(t){return await this._request(p.api.attr.getBookmarkLabels.pathname,p.api.attr.getBookmarkLabels.method,void 0,t)}async setBlockAttrs(t,n){return await this._request(p.api.attr.setBlockAttrs.pathname,p.api.attr.setBlockAttrs.method,t,n)}async appendBlock(t,n){return await this._request(p.api.block.appendBlock.pathname,p.api.block.appendBlock.method,t,n)}async deleteBlock(t,n){return await this._request(p.api.block.deleteBlock.pathname,p.api.block.deleteBlock.method,t,n)}async getBlockBreadcrumb(t,n){return await this._request(p.api.block.getBlockBreadcrumb.pathname,p.api.block.getBlockBreadcrumb.method,t,n)}async getBlockDOM(t,n){return await this._request(p.api.block.getBlockDOM.pathname,p.api.block.getBlockDOM.method,t,n)}async getBlockInfo(t,n){return await this._request(p.api.block.getBlockInfo.pathname,p.api.block.getBlockInfo.method,t,n)}async getBlockKramdown(t,n){return await this._request(p.api.block.getBlockKramdown.pathname,p.api.block.getBlockKramdown.method,t,n)}async getChildBlocks(t,n){return await this._request(p.api.block.getChildBlocks.pathname,p.api.block.getChildBlocks.method,t,n)}async getDocInfo(t,n){return await this._request(p.api.block.getDocInfo.pathname,p.api.block.getDocInfo.method,t,n)}async insertBlock(t,n){return await this._request(p.api.block.insertBlock.pathname,p.api.block.insertBlock.method,t,n)}async moveBlock(t,n){return await this._request(p.api.block.moveBlock.pathname,p.api.block.moveBlock.method,t,n)}async prependBlock(t,n){return await this._request(p.api.block.prependBlock.pathname,p.api.block.prependBlock.method,t,n)}async transferBlockRef(t,n){return await this._request(p.api.block.transferBlockRef.pathname,p.api.block.transferBlockRef.method,t,n)}async updateBlock(t,n){return await this._request(p.api.block.updateBlock.pathname,p.api.block.updateBlock.method,t,n)}async channels(t){return await this._request(p.api.broadcast.channels.pathname,p.api.broadcast.channels.method,void 0,t)}async getChannelInfo(t,n){return await this._request(p.api.broadcast.getChannelInfo.pathname,p.api.broadcast.getChannelInfo.method,t,n)}async postMessage(t,n){return await this._request(p.api.broadcast.postMessage.pathname,p.api.broadcast.postMessage.method,t,n)}async pandoc(t,n){return await this._request(p.api.convert.pandoc.pathname,p.api.convert.pandoc.method,t,n)}async exportResources(t,n){return await this._request(p.api.export.exportResources.pathname,p.api.export.exportResources.method,t,n)}async exportMdContent(t,n){return await this._request(p.api.export.exportMdContent.pathname,p.api.export.exportMdContent.method,t,n)}async getFile(t,n="text",o){return await this._request(p.api.file.getFile.pathname,p.api.file.getFile.method,t,o,!1,n)}async putFile(t,n){t.file!==void 0&&!(t.file instanceof File)&&(t.file=new File([t.file],t.path.split("/").pop()));const o=new FormData;for(const[r,s]of Object.entries(t))t.hasOwnProperty(r)&&(s instanceof Blob?o.append(r,s):o.append(r,String(s)));return await this._request(p.api.file.putFile.pathname,p.api.file.putFile.method,o,n)}async readDir(t,n){return await this._request(p.api.file.readDir.pathname,p.api.file.readDir.method,t,n)}async removeFile(t,n){return await this._request(p.api.file.removeFile.pathname,p.api.file.removeFile.method,t,n)}async renameFile(t,n){return await this._request(p.api.file.renameFile.pathname,p.api.file.renameFile.method,t,n)}async createDocWithMd(t,n){return await this._request(p.api.filetree.createDocWithMd.pathname,p.api.filetree.createDocWithMd.method,t,n)}async getDoc(t,n){return await this._request(p.api.filetree.getDoc.pathname,p.api.filetree.getDoc.method,t,n)}async getHPathByID(t,n){return await this._request(p.api.filetree.getHPathByID.pathname,p.api.filetree.getHPathByID.method,t,n)}async getHPathByPath(t,n){return await this._request(p.api.filetree.getHPathByPath.pathname,p.api.filetree.getHPathByPath.method,t,n)}async listDocsByPath(t,n){return await this._request(p.api.filetree.listDocsByPath.pathname,p.api.filetree.listDocsByPath.method,t,n)}async moveDocs(t,n){return await this._request(p.api.filetree.moveDocs.pathname,p.api.filetree.moveDocs.method,t,n)}async removeDoc(t,n){return await this._request(p.api.filetree.removeDoc.pathname,p.api.filetree.removeDoc.method,t,n)}async renameDoc(t,n){return await this._request(p.api.filetree.renameDoc.pathname,p.api.filetree.renameDoc.method,t,n)}async searchDocs(t,n){return await this._request(p.api.filetree.searchDocs.pathname,p.api.filetree.searchDocs.method,t,n)}async getDocHistoryContent(t,n){return await this._request(p.api.history.getDocHistoryContent.pathname,p.api.history.getDocHistoryContent.method,t,n)}async getHistoryItems(t,n){return await this._request(p.api.history.getHistoryItems.pathname,p.api.history.getHistoryItems.method,t,n)}async getShorthand(t,n){return await this._request(p.api.inbox.getShorthand.pathname,p.api.inbox.getShorthand.method,t,n)}async forwardProxy(t,n){return await this._request(p.api.network.forwardProxy.pathname,p.api.network.forwardProxy.method,t,n)}async closeNotebook(t,n){return await this._request(p.api.notebook.closeNotebook.pathname,p.api.notebook.closeNotebook.method,t,n)}async createNotebook(t,n){return await this._request(p.api.notebook.createNotebook.pathname,p.api.notebook.createNotebook.method,t,n)}async getNotebookConf(t,n){return await this._request(p.api.notebook.getNotebookConf.pathname,p.api.notebook.getNotebookConf.method,t,n)}async lsNotebooks(t){return await this._request(p.api.notebook.lsNotebooks.pathname,p.api.notebook.lsNotebooks.method,void 0,t)}async openNotebook(t,n){return await this._request(p.api.notebook.openNotebook.pathname,p.api.notebook.openNotebook.method,t,n)}async removeNotebook(t,n){return await this._request(p.api.notebook.removeNotebook.pathname,p.api.notebook.removeNotebook.method,t,n)}async renameNotebook(t,n){return await this._request(p.api.notebook.renameNotebook.pathname,p.api.notebook.renameNotebook.method,t,n)}async setNotebookConf(t,n){return await this._request(p.api.notebook.setNotebookConf.pathname,p.api.notebook.setNotebookConf.method,t,n)}async pushErrMsg(t,n){return await this._request(p.api.notification.pushErrMsg.pathname,p.api.notification.pushErrMsg.method,t,n)}async pushMsg(t,n){return await this._request(p.api.notification.pushMsg.pathname,p.api.notification.pushMsg.method,t,n)}async sql(t,n){return await this._request(p.api.query.sql.pathname,p.api.query.sql.method,t,n)}async openRepoSnapshotDoc(t,n){return await this._request(p.api.repo.openRepoSnapshotDoc.pathname,p.api.repo.openRepoSnapshotDoc.method,t,n)}async getSnippet(t,n){return await this._request(p.api.snippet.getSnippet.pathname,p.api.snippet.getSnippet.method,t,n)}async setSnippet(t,n){return await this._request(p.api.snippet.setSnippet.pathname,p.api.snippet.setSnippet.method,t,n)}async getRecentDocs(t){return await this._request(p.api.storage.getRecentDocs.pathname,p.api.storage.getRecentDocs.method,void 0,t)}async bootProgress(t){return await this._request(p.api.system.bootProgress.pathname,p.api.system.bootProgress.method,void 0,t)}async currentTime(t){return await this._request(p.api.system.currentTime.pathname,p.api.system.currentTime.method,void 0,t)}async version(t){return await this._request(p.api.system.version.pathname,p.api.system.version.method,void 0,t)}async render(t,n){return await this._request(p.api.template.render.pathname,p.api.template.render.method,t,n)}async renderSprig(t,n){return await this._request(p.api.template.renderSprig.pathname,p.api.template.renderSprig.method,t,n)}async _request(t,n,o,r,s=!0,i="json"){try{switch((r==null?void 0:r.type)??this._type){case"fetch":{const a=r==null?void 0:r.options;i=(()=>{switch(i){case"arraybuffer":return"arrayBuffer";case"document":return"text";default:return i}})();const l=await this._fetch(t,{method:n,body:o,responseType:i,onResponse:async u=>{switch(u.response.status){case Le.Ok:break;case Le.Accepted:t===p.api.file.getFile.pathname&&this._parseFetchResponse(u.response._data);break;default:break}},...a});return s&&i==="json"&&typeof l=="object"?this._parseFetchResponse(l):l}case"xhr":default:{const a=r==null?void 0:r.options;i=(()=>{switch(i){case"arrayBuffer":return"arraybuffer";default:return i}})();const l=await this._axios.request({url:t,method:n,data:o,responseType:i,...a});switch(l.status){case Le.Ok:return s&&i==="json"&&typeof l.data=="object"?this._parseAxiosResponse(l):l.data;case Le.Accepted:return t===p.api.file.getFile.pathname?this._parseAxiosResponse(l):l.data;default:throw new wr(l)}}}}catch(a){throw a}}_parseFetchResponse(t){if(t.code===0)return t;throw new Dt(t)}_parseAxiosResponse(t){if(t.data.code===0)return t.data;throw new Dt(t.data,t)}};se(ht,"ws",{broadcast:{pathname:"/ws/broadcast"}}),se(ht,"api",{search:{fullTextSearchBlock:{pathname:"/api/search/fullTextSearchBlock",method:"POST"}},asset:{upload:{pathname:"/api/asset/upload",method:"POST"}},attr:{getBlockAttrs:{pathname:"/api/attr/getBlockAttrs",method:"POST"},setBlockAttrs:{pathname:"/api/attr/setBlockAttrs",method:"POST"},getBookmarkLabels:{pathname:"/api/attr/getBookmarkLabels",method:"POST"}},block:{appendBlock:{pathname:"/api/block/appendBlock",method:"POST"},deleteBlock:{pathname:"/api/block/deleteBlock",method:"POST"},getBlockBreadcrumb:{pathname:"/api/block/getBlockBreadcrumb",method:"POST"},getBlockDOM:{pathname:"/api/block/getBlockDOM",method:"POST"},getBlockInfo:{pathname:"/api/block/getBlockInfo",method:"POST"},getBlockKramdown:{pathname:"/api/block/getBlockKramdown",method:"POST"},getChildBlocks:{pathname:"/api/block/getChildBlocks",method:"POST"},getDocInfo:{pathname:"/api/block/getDocInfo",method:"POST"},insertBlock:{pathname:"/api/block/insertBlock",method:"POST"},moveBlock:{pathname:"/api/block/moveBlock",method:"POST"},prependBlock:{pathname:"/api/block/prependBlock",method:"POST"},transferBlockRef:{pathname:"/api/block/transferBlockRef",method:"POST"},updateBlock:{pathname:"/api/block/updateBlock",method:"POST"}},broadcast:{channels:{pathname:"/api/broadcast/channels",method:"GET"},getChannelInfo:{pathname:"/api/broadcast/getChannelInfo",method:"POST"},postMessage:{pathname:"/api/broadcast/postMessage",method:"POST"}},convert:{pandoc:{pathname:"/api/convert/pandoc",method:"POST"}},export:{exportMdContent:{pathname:"/api/export/exportMdContent",method:"POST"},exportResources:{pathname:"/api/export/exportResources",method:"POST"}},file:{getFile:{pathname:"/api/file/getFile",method:"POST"},putFile:{pathname:"/api/file/putFile",method:"POST"},readDir:{pathname:"/api/file/readDir",method:"POST"},removeFile:{pathname:"/api/file/removeFile",method:"POST"},renameFile:{pathname:"/api/file/renameFile",method:"POST"}},filetree:{createDocWithMd:{pathname:"/api/filetree/createDocWithMd",method:"POST"},getDoc:{pathname:"/api/filetree/getDoc",method:"POST"},getHPathByID:{pathname:"/api/filetree/getHPathByID",method:"POST"},getHPathByPath:{pathname:"/api/filetree/getHPathByPath",method:"POST"},listDocsByPath:{pathname:"/api/filetree/listDocsByPath",method:"POST"},moveDocs:{pathname:"/api/filetree/moveDocs",method:"POST"},removeDoc:{pathname:"/api/filetree/removeDoc",method:"POST"},renameDoc:{pathname:"/api/filetree/renameDoc",method:"POST"},searchDocs:{pathname:"/api/filetree/searchDocs",method:"POST"}},history:{getDocHistoryContent:{pathname:"/api/history/getDocHistoryContent",method:"POST"},getHistoryItems:{pathname:"/api/history/getHistoryItems",method:"POST"}},inbox:{getShorthand:{pathname:"/api/inbox/getShorthand",method:"POST"}},network:{forwardProxy:{pathname:"/api/network/forwardProxy",method:"POST"}},notebook:{closeNotebook:{pathname:"/api/notebook/closeNotebook",method:"POST"},createNotebook:{pathname:"/api/notebook/createNotebook",method:"POST"},lsNotebooks:{pathname:"/api/notebook/lsNotebooks",method:"POST"},getNotebookConf:{pathname:"/api/notebook/getNotebookConf",method:"POST"},openNotebook:{pathname:"/api/notebook/openNotebook",method:"POST"},removeNotebook:{pathname:"/api/notebook/removeNotebook",method:"POST"},renameNotebook:{pathname:"/api/notebook/renameNotebook",method:"POST"},setNotebookConf:{pathname:"/api/notebook/setNotebookConf",method:"POST"}},notification:{pushErrMsg:{pathname:"/api/notification/pushErrMsg",method:"POST"},pushMsg:{pathname:"/api/notification/pushMsg",method:"POST"}},query:{sql:{pathname:"/api/query/sql",method:"POST"}},repo:{openRepoSnapshotDoc:{pathname:"/api/repo/openRepoSnapshotDoc",method:"POST"}},snippet:{getSnippet:{pathname:"/api/snippet/getSnippet",method:"POST"},setSnippet:{pathname:"/api/snippet/setSnippet",method:"POST"}},storage:{getRecentDocs:{pathname:"/api/storage/getRecentDocs",method:"POST"}},system:{bootProgress:{pathname:"/api/system/bootProgress",method:"POST"},currentTime:{pathname:"/api/system/currentTime",method:"POST"},version:{pathname:"/api/system/version",method:"POST"},getConf:{pathname:"/api/system/getConf",method:"POST"}},template:{render:{pathname:"/api/template/render",method:"POST"},renderSprig:{pathname:"/api/template/renderSprig",method:"POST"}}});let Is=ht;var $n=(e=>(e.NodeNotebook="NodeNotebook",e.NodeFolder="NodeFolder",e.NodeDocument="NodeDocument",e.NodeSuperBlock="NodeSuperBlock",e.NodeBlockquote="NodeBlockquote",e.NodeList="NodeList",e.NodeListItem="NodeListItem",e.NodeHeading="NodeHeading",e.NodeParagraph="NodeParagraph",e.NodeMathBlock="NodeMathBlock",e.NodeTable="NodeTable",e.NodeCodeBlock="NodeCodeBlock",e.NodeHTMLBlock="NodeHTMLBlock",e.NodeThematicBreak="NodeThematicBreak",e.NodeAudio="NodeAudio",e.NodeVideo="NodeVideo",e.NodeIFrame="NodeIFrame",e.NodeWidget="NodeWidget",e.NodeBlockQueryEmbed="NodeBlockQueryEmbed",e))($n||{}),eo=(e=>(e.d="d",e.s="s",e.b="b",e.l="l",e.i="i",e.h="h",e.p="p",e.m="m",e.t="t",e.c="c",e.html="html",e.query_embed="query_embed",e.tb="tb",e.audio="audio",e.video="video",e.iframe="iframe",e.widget="widget",e))(eo||{}),to=(e=>(e.d="d",e.s="s",e.b="b",e.l="l",e.i="i",e))(to||{}),no=(e=>(e.h="h",e.p="p",e.m="m",e.t="t",e.c="c",e.html="html",e.query_embed="query_embed",e.tb="tb",e.audio="audio",e.video="video",e.iframe="iframe",e.widget="widget",e))(no||{}),oo=(e=>(e.h1="h1",e.h2="h2",e.h3="h3",e.h4="h4",e.h5="h5",e.h6="h6",e.u="u",e.o="o",e.t="t",e.none="",e))(oo||{}),ro=(e=>(e.u="u",e.o="o",e.t="t",e))(ro||{}),so=(e=>(e.h1="h1",e.h2="h2",e.h3="h3",e.h4="h4",e.h5="h5",e.h6="h6",e))(so||{}),io=(e=>(e[e.keyword=0]="keyword",e[e.querySyntax=1]="querySyntax",e[e.sql=2]="sql",e[e.regex=3]="regex",e))(io||{}),ao=(e=>(e[e.noGroupBy=0]="noGroupBy",e[e.group=1]="group",e))(ao||{}),lo=(e=>(e[e.type=0]="type",e[e.createdASC=1]="createdASC",e[e.createdDESC=2]="createdDESC",e[e.modifiedASC=3]="modifiedASC",e[e.modifiedDESC=4]="modifiedDESC",e[e.sortByContent=5]="sortByContent",e[e.sortByRankAsc=6]="sortByRankAsc",e[e.sortByRankDesc=7]="sortByRankDesc",e))(lo||{}),co=(e=>(e[e.SortModeNameASC=0]="SortModeNameASC",e[e.SortModeNameDESC=1]="SortModeNameDESC",e[e.SortModeUpdatedASC=2]="SortModeUpdatedASC",e[e.SortModeUpdatedDESC=3]="SortModeUpdatedDESC",e[e.SortModeAlphanumASC=4]="SortModeAlphanumASC",e[e.SortModeAlphanumDESC=5]="SortModeAlphanumDESC",e[e.SortModeCustom=6]="SortModeCustom",e[e.SortModeRefCountASC=7]="SortModeRefCountASC",e[e.SortModeRefCountDESC=8]="SortModeRefCountDESC",e[e.SortModeCreatedASC=9]="SortModeCreatedASC",e[e.SortModeCreatedDESC=10]="SortModeCreatedDESC",e[e.SortModeSizeASC=11]="SortModeSizeASC",e[e.SortModeSizeDESC=12]="SortModeSizeDESC",e[e.SortModeSubDocCountASC=13]="SortModeSubDocCountASC",e[e.SortModeSubDocCountDESC=14]="SortModeSubDocCountDESC",e))(co||{});const w=Object.freeze(Object.defineProperty({__proto__:null,BlockSubType:oo,BlockType:eo,Container:to,GroupBy:ao,Leaf:no,Method:io,NodeHeadingSubType:so,NodeListSubType:ro,NodeType:$n,OrderBy:lo,SortMode:co},Symbol.toStringTag,{value:"Module"}));Us();Hs();const Qt=zs();function Us(){switch(he.getFrontend()){case"desktop":case"desktop-window":case"browser-desktop":return!0;case"mobile":case"browser-mobile":return!1;default:return!1}}function zs(){switch(he.getFrontend()){case"mobile":case"browser-mobile":return!0;case"desktop":case"desktop-window":case"browser-desktop":return!1;default:return!1}}function Hs(){switch(he.getFrontend()){case"browser-desktop":case"browser-mobile":return!0;case"desktop":case"desktop-window":case"mobile":return!1;default:return!1}}class Ws{constructor(t,n=!0){this.label=t,this.collapsed=n}stdout(t,n,...o){const r=`[\x1B[4m${this.label}\x1B[0m] - <\x1B[1m${t.name.toUpperCase()}\x1B[0m>`;if(this.collapsed?globalThis.console.groupCollapsed(r):globalThis.console.group(r),n)for(const s of o)Array.isArray(s)?t(...s):t(s);else t(...o);globalThis.console.trace(),globalThis.console.groupEnd()}dir(...t){this.stdout(globalThis.console.dir,!1,...t)}dirs(...t){this.stdout(globalThis.console.dir,!0,...t)}table(...t){this.stdout(globalThis.console.table,!1,...t)}tables(...t){this.stdout(globalThis.console.table,!0,...t)}debug(...t){this.stdout(globalThis.console.debug,!1,...t)}debugs(...t){this.stdout(globalThis.console.debug,!0,...t)}info(...t){this.stdout(globalThis.console.info,!1,...t)}infos(...t){this.stdout(globalThis.console.info,!0,...t)}log(...t){this.stdout(globalThis.console.log,!1,...t)}logs(...t){this.stdout(globalThis.console.log,!0,...t)}warn(...t){this.stdout(globalThis.console.warn,!1,...t)}warns(...t){this.stdout(globalThis.console.warn,!0,...t)}error(...t){this.stdout(globalThis.console.error,!1,...t)}errors(...t){this.stdout(globalThis.console.error,!0,...t)}}function Vs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Gs=function(t){return Js(t)&&!Ks(t)};function Js(e){return!!e&&typeof e=="object"}function Ks(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||Zs(e)}var Qs=typeof Symbol=="function"&&Symbol.for,Ys=Qs?Symbol.for("react.element"):60103;function Zs(e){return e.$$typeof===Ys}function Xs(e){return Array.isArray(e)?[]:{}}function Re(e,t){return t.clone!==!1&&t.isMergeableObject(e)?Te(Xs(e),e,t):e}function xs(e,t,n){return e.concat(t).map(function(o){return Re(o,n)})}function $s(e,t){if(!t.customMerge)return Te;var n=t.customMerge(e);return typeof n=="function"?n:Te}function ei(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function Yt(e){return Object.keys(e).concat(ei(e))}function uo(e,t){try{return t in e}catch{return!1}}function ti(e,t){return uo(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function ni(e,t,n){var o={};return n.isMergeableObject(e)&&Yt(e).forEach(function(r){o[r]=Re(e[r],n)}),Yt(t).forEach(function(r){ti(e,r)||(uo(e,r)&&n.isMergeableObject(t[r])?o[r]=$s(r,n)(e[r],t[r],n):o[r]=Re(t[r],n))}),o}function Te(e,t,n){n=n||{},n.arrayMerge=n.arrayMerge||xs,n.isMergeableObject=n.isMergeableObject||Gs,n.cloneUnlessOtherwiseSpecified=Re;var o=Array.isArray(t),r=Array.isArray(e),s=o===r;return s?o?n.arrayMerge(e,t,n):ni(e,t,n):Re(t,n)}Te.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(o,r){return Te(o,r,n)},{})};var oi=Te,ri=oi;const si=Vs(ri);function Zt(...e){return si.all(e,{arrayMerge:(t,n,o)=>n})}function Xt(e){const[t,n,o]=e.split(/[+-]/)[0].split(".").map(r=>parseInt(r));return t*1e8+n*1e4+o}function ii(e,t){const n=Xt(e),o=Xt(t);return n-o}function ai(e){const{protyle:t,data:n,blockElements:o}=e;if(n){const r={element:t.wysiwyg.element,id:n.id,type:w.NodeType.NodeDocument};return{...r,isDocumentBlock:!0,isMultiBlock:!1,blocks:[r],protyle:t,data:n}}else if(o&&o.length>0){const r=[];return o.forEach(s=>{r.push({element:s,id:s.dataset.nodeId,type:s.dataset.type,subtype:s.dataset.subtype})}),{...r[0],isDocumentBlock:!1,isMultiBlock:r.length>1,blocks:r,protyle:t}}return null}function U(){}function li(e,t){for(const n in t)e[n]=t[n];return e}function fo(e){return e()}function xt(){return Object.create(null)}function I(e){e.forEach(fo)}function po(e){return typeof e=="function"}function ae(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ci(e){return Object.keys(e).length===0}function x(e,t,n,o){if(e){const r=ho(e,t,n,o);return e[0](r)}}function ho(e,t,n,o){return e[1]&&o?li(n.ctx.slice(),e[1](o(t))):n.ctx}function $(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const s=[],i=Math.max(t.dirty.length,r.length);for(let a=0;a<i;a+=1)s[a]=t.dirty[a]|r[a];return s}return t.dirty|r}return t.dirty}function ee(e,t,n,o,r,s){if(r){const i=ho(t,n,o,s);e.p(i,r)}}function te(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let o=0;o<n;o++)t[o]=-1;return t}return-1}function R(e,t){e.appendChild(t)}function N(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function O(e){return document.createElement(e)}function be(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function _e(e){return document.createTextNode(e)}function q(){return _e(" ")}function ge(){return _e("")}function F(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function k(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Pe(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function mt(e){return e===""?null:+e}function ui(e){return Array.from(e.childNodes)}function xe(e,t){t=""+t,e.data!==t&&(e.data=t)}function Q(e,t){e.value=t??""}function oe(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function $t(e,t,n){for(let o=0;o<e.options.length;o+=1){const r=e.options[o];if(r.__value===t){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function fi(e){const t=e.querySelector(":checked");return t&&t.__value}function E(e,t,n){e.classList[n?"add":"remove"](t)}function di(e,t,{bubbles:n=!1,cancelable:o=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,o,t),r}class Et{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,n,o=null){this.e||(this.is_svg?this.e=be(n.nodeName):this.e=O(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(t)),this.i(o)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(t){for(let n=0;n<this.n.length;n+=1)N(this.t,this.n[n],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(S)}}let Me;function Ce(e){Me=e}function mo(){if(!Me)throw new Error("Function called outside component initialization");return Me}function pi(e){mo().$$.on_mount.push(e)}function Tt(){const e=mo();return(t,n,{cancelable:o=!1}={})=>{const r=e.$$.callbacks[t];if(r){const s=di(t,n,{cancelable:o});return r.slice().forEach(i=>{i.call(e,s)}),!s.defaultPrevented}return!0}}const Ne=[],Ge=[];let ve=[];const en=[],hi=Promise.resolve();let bt=!1;function mi(){bt||(bt=!0,hi.then(bo))}function Je(e){ve.push(e)}const it=new Set;let we=0;function bo(){if(we!==0)return;const e=Me;do{try{for(;we<Ne.length;){const t=Ne[we];we++,Ce(t),bi(t.$$)}}catch(t){throw Ne.length=0,we=0,t}for(Ce(null),Ne.length=0,we=0;Ge.length;)Ge.pop()();for(let t=0;t<ve.length;t+=1){const n=ve[t];it.has(n)||(it.add(n),n())}ve.length=0}while(Ne.length);for(;en.length;)en.pop()();bt=!1,it.clear(),Ce(e)}function bi(e){if(e.fragment!==null){e.update(),I(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Je)}}function gi(e){const t=[],n=[];ve.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),ve=t}const We=new Set;let me;function de(){me={r:0,c:[],p:me}}function pe(){me.r||I(me.c),me=me.p}function v(e,t){e&&e.i&&(We.delete(e),e.i(t))}function A(e,t,n,o){if(e&&e.o){if(We.has(e))return;We.add(e),me.c.push(()=>{We.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function _i(e,t){e.d(1),t.delete(e.key)}function go(e,t){A(e,1,1,()=>{t.delete(e.key)})}function At(e,t,n,o,r,s,i,a,l,u,c,_){let g=e.length,d=s.length,b=g;const m={};for(;b--;)m[e[b].key]=b;const f=[],y=new Map,M=new Map,Y=[];for(b=d;b--;){const L=_(r,s,b),V=n(L);let G=i.get(V);G?o&&Y.push(()=>G.p(L,t)):(G=u(V,L),G.c()),y.set(V,f[b]=G),V in m&&M.set(V,Math.abs(b-m[V]))}const ye=new Set,ke=new Set;function C(L){v(L,1),L.m(a,c),i.set(L.key,L),c=L.first,d--}for(;g&&d;){const L=f[d-1],V=e[g-1],G=L.key,T=V.key;L===V?(c=L.first,g--,d--):y.has(T)?!i.has(G)||ye.has(G)?C(L):ke.has(T)?g--:M.get(G)>M.get(T)?(ke.add(G),C(L)):(ye.add(T),g--):(l(V,i),g--)}for(;g--;){const L=e[g];y.has(L.key)||l(L,i)}for(;d;)C(f[d-1]);return I(Y),f}function W(e){e&&e.c()}function z(e,t,n,o){const{fragment:r,after_update:s}=e.$$;r&&r.m(t,n),o||Je(()=>{const i=e.$$.on_mount.map(fo).filter(po);e.$$.on_destroy?e.$$.on_destroy.push(...i):I(i),e.$$.on_mount=[]}),s.forEach(Je)}function H(e,t){const n=e.$$;n.fragment!==null&&(gi(n.after_update),I(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function yi(e,t){e.$$.dirty[0]===-1&&(Ne.push(e),mi(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function le(e,t,n,o,r,s,i,a=[-1]){const l=Me;Ce(e);const u=e.$$={fragment:null,ctx:[],props:s,update:U,not_equal:r,bound:xt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:xt(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};i&&i(u.root);let c=!1;if(u.ctx=n?n(e,t.props||{},(_,g,...d)=>{const b=d.length?d[0]:g;return u.ctx&&r(u.ctx[_],u.ctx[_]=b)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](b),c&&yi(e,_)),g}):[],u.update(),c=!0,I(u.before_update),u.fragment=o?o(u.ctx):!1,t.target){if(t.hydrate){const _=ui(t.target);u.fragment&&u.fragment.l(_),_.forEach(S)}else u.fragment&&u.fragment.c();t.intro&&v(e.$$.fragment),z(e,t.target,t.anchor,t.customElement),bo()}Ce(l)}class ce{$destroy(){H(this,1),this.$destroy=U}$on(t,n){if(!po(n))return U;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(t){this.$$set&&!ci(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const tn={id:/^\d{14}-[0-9a-z]{7}$/,url:/^siyuan:\/\/blocks\/(\d{14}-[0-9a-z]{7})/,snippet:/^\d{14}-[0-9a-z]{7}$/,created:/^\d{10}$/,history:/[\/\\]history[\/\\]\d{4}-\d{2}-\d{2}-\d{6}-(clean|update|delete|format|sync|replace)([\/\\]\d{14}-[0-9a-z]{7})+\.sy$/,snapshot:/^[0-9a-f]{40}$/,shorthand:/^\d{13}$/};function ki(e){let t,n;return{c(){t=be("svg"),n=be("use"),Pe(n,"xlink:href",e[0]),k(t,"style",e[3]),k(t,"data-id",e[1]),k(t,"class",e[2]),E(t,"popover__block",tn.id.test(e[1]))},m(o,r){N(o,t,r),R(t,n)},p(o,[r]){r&1&&Pe(n,"xlink:href",o[0]),r&8&&k(t,"style",o[3]),r&2&&k(t,"data-id",o[1]),r&4&&k(t,"class",o[2]),r&6&&E(t,"popover__block",tn.id.test(o[1]))},i:U,o:U,d(o){o&&S(t)}}}function wi(e,t,n){let{icon:o}=t,{id:r=""}=t,{className:s=""}=t,{style:i=""}=t;return e.$$set=a=>{"icon"in a&&n(0,o=a.icon),"id"in a&&n(1,r=a.id),"className"in a&&n(2,s=a.className),"style"in a&&n(3,i=a.style)},[o,r,s,i]}class $e extends ce{constructor(t){super(),le(this,t,wi,ki,ae,{icon:0,id:1,className:2,style:3})}}const Si=e=>({focus:e&1}),nn=e=>({focus:e[0]});function on(e,t,n){const o=e.slice();return o[13]=t[n],o}function rn(e){let t,n,o,r,s,i,a;return n=new $e({props:{icon:"#iconSearch",className:"b3-form__icon-icon"}}),{c(){t=O("div"),W(n.$$.fragment),o=q(),r=O("input"),k(r,"placeholder",e[4]),k(r,"class","b3-text-field fn__block b3-form__icon-input"),k(t,"class","b3-form__icon")},m(l,u){N(l,t,u),z(n,t,null),R(t,o),R(t,r),Q(r,e[1]),s=!0,i||(a=[F(r,"input",e[9]),F(r,"change",e[5])],i=!0)},p(l,u){(!s||u&16)&&k(r,"placeholder",l[4]),u&2&&r.value!==l[1]&&Q(r,l[1])},i(l){s||(v(n.$$.fragment,l),s=!0)},o(l){A(n.$$.fragment,l),s=!1},d(l){l&&S(t),H(n),i=!1,I(a)}}}function sn(e,t){let n,o,r,s,i=t[13].text+"",a,l,u,c,_;o=new $e({props:{icon:t[13].icon,className:"b3-list-item__graphic"}});function g(){return t[10](t[13])}function d(){return t[11](t[13])}return{key:e,first:null,c(){n=O("li"),W(o.$$.fragment),r=q(),s=O("span"),a=q(),k(s,"class","b3-list-item__text svelte-15drd7h"),k(n,"role","button"),k(n,"data-name",l=t[13].name),k(n,"class","b3-list-item"),E(n,"b3-list-item--focus",t[13].key===t[0]),this.first=n},m(b,m){N(b,n,m),z(o,n,null),R(n,r),R(n,s),s.innerHTML=i,R(n,a),u=!0,c||(_=[F(n,"click",g),F(n,"keyup",d)],c=!0)},p(b,m){t=b;const f={};m&4&&(f.icon=t[13].icon),o.$set(f),(!u||m&4)&&i!==(i=t[13].text+"")&&(s.innerHTML=i),(!u||m&4&&l!==(l=t[13].name))&&k(n,"data-name",l),(!u||m&5)&&E(n,"b3-list-item--focus",t[13].key===t[0])},i(b){u||(v(o.$$.fragment,b),u=!0)},o(b){A(o.$$.fragment,b),u=!1},d(b){b&&S(n),H(o),c=!1,I(_)}}}function Ni(e){let t;return{c(){t=_e("Container")},m(n,o){N(n,t,o)},d(n){n&&S(t)}}}function vi(e){let t,n,o,r=[],s=new Map,i,a,l,u=e[3]&&rn(e),c=e[2];const _=m=>m[13].key;for(let m=0;m<c.length;m+=1){let f=on(e,c,m),y=_(f);s.set(y,r[m]=sn(y,f))}const g=e[8].default,d=x(g,e,e[7],nn),b=d||Ni();return{c(){t=O("div"),n=O("ul"),u&&u.c(),o=q();for(let m=0;m<r.length;m+=1)r[m].c();i=q(),a=O("div"),b&&b.c(),k(n,"class","b3-tab-bar b3-list b3-list--background"),k(a,"class","config__tab-wrap"),k(t,"class","fn__flex-1 fn__flex config__panel")},m(m,f){N(m,t,f),R(t,n),u&&u.m(n,null),R(n,o);for(let y=0;y<r.length;y+=1)r[y]&&r[y].m(n,null);R(t,i),R(t,a),b&&b.m(a,null),l=!0},p(m,[f]){m[3]?u?(u.p(m,f),f&8&&v(u,1)):(u=rn(m),u.c(),v(u,1),u.m(n,o)):u&&(de(),A(u,1,1,()=>{u=null}),pe()),f&69&&(c=m[2],de(),r=At(r,f,_,1,m,c,s,n,go,sn,null,on),pe()),d&&d.p&&(!l||f&129)&&ee(d,g,m,m[7],l?$(g,m[7],f,Si):te(m[7]),nn)},i(m){if(!l){v(u);for(let f=0;f<c.length;f+=1)v(r[f]);v(b,m),l=!0}},o(m){A(u);for(let f=0;f<r.length;f+=1)A(r[f]);A(b,m),l=!1},d(m){m&&S(t),u&&u.d();for(let f=0;f<r.length;f+=1)r[f].d();b&&b.d(m)}}}function Ei(e,t,n){let{$$slots:o={},$$scope:r}=t,{panels:s}=t,{focus:i}=t,{searchEnable:a=!1}=t,{searchPlaceholder:l=""}=t,{searchValue:u=""}=t;const c=Tt();function _(){c("search-changed",{value:u})}function g(f){c("changed",{key:f}),n(0,i=f)}function d(){u=this.value,n(1,u)}const b=f=>g(f.key),m=f=>g(f.key);return e.$$set=f=>{"panels"in f&&n(2,s=f.panels),"focus"in f&&n(0,i=f.focus),"searchEnable"in f&&n(3,a=f.searchEnable),"searchPlaceholder"in f&&n(4,l=f.searchPlaceholder),"searchValue"in f&&n(1,u=f.searchValue),"$$scope"in f&&n(7,r=f.$$scope)},[i,u,s,a,l,_,g,r,o,d,b,m]}class Ti extends ce{constructor(t){super(),le(this,t,Ei,vi,ae,{panels:2,focus:0,searchEnable:3,searchPlaceholder:4,searchValue:1})}}function Ai(e){let t,n;const o=e[4].default,r=x(o,e,e[3],null);return{c(){t=O("div"),r&&r.c(),k(t,"data-name",e[2]),k(t,"class","config__tab-container"),E(t,"fn__none",!e[0]),E(t,"config__tab-container--top",e[1])},m(s,i){N(s,t,i),r&&r.m(t,null),n=!0},p(s,[i]){r&&r.p&&(!n||i&8)&&ee(r,o,s,s[3],n?$(o,s[3],i,null):te(s[3]),null),(!n||i&4)&&k(t,"data-name",s[2]),(!n||i&1)&&E(t,"fn__none",!s[0]),(!n||i&2)&&E(t,"config__tab-container--top",s[1])},i(s){n||(v(r,s),n=!0)},o(s){A(r,s),n=!1},d(s){s&&S(t),r&&r.d(s)}}}function Oi(e,t,n){let{$$slots:o={},$$scope:r}=t,{display:s=!0}=t,{top:i=!0}=t,{name:a=""}=t;return e.$$set=l=>{"display"in l&&n(0,s=l.display),"top"in l&&n(1,i=l.top),"name"in l&&n(2,a=l.name),"$$scope"in l&&n(3,r=l.$$scope)},[s,i,a,r,o]}class an extends ce{constructor(t){super(),le(this,t,Oi,Ai,ae,{display:0,top:1,name:2})}}const Bi=e=>({}),ln=e=>({}),Ci=e=>({}),cn=e=>({}),Di=e=>({}),un=e=>({}),Ri=e=>({}),fn=e=>({});function Pi(e){let t,n;return{c(){t=new Et(!1),n=ge(),t.a=n},m(o,r){t.m(e[0],o,r),N(o,n,r)},p(o,r){r&1&&t.p(o[0])},d(o){o&&S(n),o&&t.d()}}}function Mi(e){let t,n;return{c(){t=new Et(!1),n=ge(),t.a=n},m(o,r){t.m(e[1],o,r),N(o,n,r)},p(o,r){r&2&&t.p(o[1])},d(o){o&&S(n),o&&t.d()}}}function dn(e){let t,n,o;const r=e[4].input,s=x(r,e,e[3],cn);return{c(){t=O("div"),n=q(),s&&s.c(),k(t,"class","fn__hr")},m(i,a){N(i,t,a),N(i,n,a),s&&s.m(i,a),o=!0},p(i,a){s&&s.p&&(!o||a&8)&&ee(s,r,i,i[3],o?$(r,i[3],a,Ci):te(i[3]),cn)},i(i){o||(v(s,i),o=!0)},o(i){A(s,i),o=!1},d(i){i&&S(t),i&&S(n),s&&s.d(i)}}}function pn(e){let t,n,o;const r=e[4].input,s=x(r,e,e[3],ln);return{c(){t=O("span"),n=q(),s&&s.c(),k(t,"class","fn__space")},m(i,a){N(i,t,a),N(i,n,a),s&&s.m(i,a),o=!0},p(i,a){s&&s.p&&(!o||a&8)&&ee(s,r,i,i[3],o?$(r,i[3],a,Bi):te(i[3]),ln)},i(i){o||(v(s,i),o=!0)},o(i){A(s,i),o=!1},d(i){i&&S(t),i&&S(n),s&&s.d(i)}}}function qi(e){let t,n,o,r,s,i,a;const l=e[4].title,u=x(l,e,e[3],fn),c=u||Pi(e),_=e[4].text,g=x(_,e,e[3],un),d=g||Mi(e);let b=e[2]&&dn(e),m=!e[2]&&pn(e);return{c(){t=O("label"),n=O("div"),c&&c.c(),o=q(),r=O("div"),d&&d.c(),s=q(),b&&b.c(),i=q(),m&&m.c(),k(r,"class","b3-label__text"),k(n,"class","fn__flex-1 svelte-2m76cy"),E(n,"visible",e[2]),k(t,"class","fn__flex b3-label")},m(f,y){N(f,t,y),R(t,n),c&&c.m(n,null),R(n,o),R(n,r),d&&d.m(r,null),R(n,s),b&&b.m(n,null),R(t,i),m&&m.m(t,null),a=!0},p(f,[y]){u?u.p&&(!a||y&8)&&ee(u,l,f,f[3],a?$(l,f[3],y,Ri):te(f[3]),fn):c&&c.p&&(!a||y&1)&&c.p(f,a?y:-1),g?g.p&&(!a||y&8)&&ee(g,_,f,f[3],a?$(_,f[3],y,Di):te(f[3]),un):d&&d.p&&(!a||y&2)&&d.p(f,a?y:-1),f[2]?b?(b.p(f,y),y&4&&v(b,1)):(b=dn(f),b.c(),v(b,1),b.m(n,null)):b&&(de(),A(b,1,1,()=>{b=null}),pe()),(!a||y&4)&&E(n,"visible",f[2]),f[2]?m&&(de(),A(m,1,1,()=>{m=null}),pe()):m?(m.p(f,y),y&4&&v(m,1)):(m=pn(f),m.c(),v(m,1),m.m(t,null))},i(f){a||(v(c,f),v(d,f),v(b),v(m),a=!0)},o(f){A(c,f),A(d,f),A(b),A(m),a=!1},d(f){f&&S(t),c&&c.d(f),d&&d.d(f),b&&b.d(),m&&m.d()}}}function Fi(e,t,n){let{$$slots:o={},$$scope:r}=t,{title:s=""}=t,{text:i=""}=t,{block:a=!1}=t;return e.$$set=l=>{"title"in l&&n(0,s=l.title),"text"in l&&n(1,i=l.text),"block"in l&&n(2,a=l.block),"$$scope"in l&&n(3,r=l.$$scope)},[s,i,a,r,o]}let Li=class extends ce{constructor(t){super(),le(this,t,Fi,qi,ae,{title:0,text:1,block:2})}};var Z=(e=>(e[e.checkbox=0]="checkbox",e[e.text=1]="text",e[e.number=2]="number",e[e.slider=3]="slider",e[e.button=4]="button",e[e.select=5]="select",e[e.textarea=6]="textarea",e))(Z||{});function hn(e,t,n){const o=e.slice();return o[19]=t[n],o}function ji(e){let t,n,o;return{c(){t=O("textarea"),t.disabled=e[2],k(t,"class","b3-text-field"),k(t,"placeholder",e[5]),E(t,"fn__block",e[3]),E(t,"fn__size200",!e[3]&&e[4]),oe(t,"height",e[8]>0?`${e[8]}px`:void 0)},m(r,s){N(r,t,s),Q(t,e[0]),n||(o=[F(t,"input",e[17]),F(t,"change",e[10])],n=!0)},p(r,s){s&4&&(t.disabled=r[2]),s&32&&k(t,"placeholder",r[5]),s&65&&Q(t,r[0]),s&8&&E(t,"fn__block",r[3]),s&24&&E(t,"fn__size200",!r[3]&&r[4]),s&256&&oe(t,"height",r[8]>0?`${r[8]}px`:void 0)},d(r){r&&S(t),n=!1,I(o)}}}function Ii(e){let t,n=[],o=new Map,r,s,i=e[6];const a=l=>l[19].key;for(let l=0;l<i.length;l+=1){let u=hn(e,i,l),c=a(u);o.set(c,n[l]=mn(c,u))}return{c(){t=O("select");for(let l=0;l<n.length;l+=1)n[l].c();t.disabled=e[2],k(t,"class","b3-select"),e[0]===void 0&&Je(()=>e[16].call(t)),E(t,"fn__block",e[3]),E(t,"fn__size200",!e[3]&&e[4]),E(t,"fn__flex-center",!e[3])},m(l,u){N(l,t,u);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(t,null);$t(t,e[0],!0),r||(s=[F(t,"change",e[16]),F(t,"change",e[10])],r=!0)},p(l,u){u&64&&(i=l[6],n=At(n,u,a,1,l,i,o,t,_i,mn,null,hn)),u&4&&(t.disabled=l[2]),u&65&&$t(t,l[0]),u&8&&E(t,"fn__block",l[3]),u&24&&E(t,"fn__size200",!l[3]&&l[4]),u&8&&E(t,"fn__flex-center",!l[3])},d(l){l&&S(t);for(let u=0;u<n.length;u+=1)n[u].d();r=!1,I(s)}}}function Ui(e){let t,n,o,r;return{c(){t=O("button"),n=_e(e[0]),t.disabled=e[2],k(t,"class","b3-button b3-button--outline"),E(t,"fn__block",e[3]),E(t,"fn__size200",!e[3]&&e[4]),E(t,"fn__flex-center",!e[3])},m(s,i){N(s,t,i),R(t,n),o||(r=F(t,"click",e[9]),o=!0)},p(s,i){i&1&&xe(n,s[0]),i&4&&(t.disabled=s[2]),i&8&&E(t,"fn__block",s[3]),i&24&&E(t,"fn__size200",!s[3]&&s[4]),i&8&&E(t,"fn__flex-center",!s[3])},d(s){s&&S(t),o=!1,r()}}}function zi(e){let t,n,o,r,s,i;return{c(){t=O("input"),t.disabled=e[2],k(t,"class","b3-slider svelte-edt8og"),k(t,"type","range"),k(t,"min",n=e[7].min),k(t,"max",o=e[7].max),k(t,"step",r=e[7].step),E(t,"fn__block",e[3]),E(t,"fn__size200",!e[3]&&e[4])},m(a,l){N(a,t,l),Q(t,e[0]),s||(i=[F(t,"change",e[15]),F(t,"input",e[15]),F(t,"change",e[10])],s=!0)},p(a,l){l&4&&(t.disabled=a[2]),l&128&&n!==(n=a[7].min)&&k(t,"min",n),l&128&&o!==(o=a[7].max)&&k(t,"max",o),l&128&&r!==(r=a[7].step)&&k(t,"step",r),l&65&&Q(t,a[0]),l&8&&E(t,"fn__block",a[3]),l&24&&E(t,"fn__size200",!a[3]&&a[4])},d(a){a&&S(t),s=!1,I(i)}}}function Hi(e){let t,n,o,r,s,i;return{c(){t=O("input"),t.disabled=e[2],k(t,"class","b3-text-field"),k(t,"type","number"),k(t,"placeholder",e[5]),k(t,"min",n=e[7].min),k(t,"max",o=e[7].max),k(t,"step",r=e[7].step),E(t,"fn__block",e[3]),E(t,"fn__size200",!e[3]&&e[4]),E(t,"fn__flex-center",!e[3])},m(a,l){N(a,t,l),Q(t,e[0]),s||(i=[F(t,"input",e[14]),F(t,"change",e[10])],s=!0)},p(a,l){l&4&&(t.disabled=a[2]),l&32&&k(t,"placeholder",a[5]),l&128&&n!==(n=a[7].min)&&k(t,"min",n),l&128&&o!==(o=a[7].max)&&k(t,"max",o),l&128&&r!==(r=a[7].step)&&k(t,"step",r),l&65&&mt(t.value)!==a[0]&&Q(t,a[0]),l&8&&E(t,"fn__block",a[3]),l&24&&E(t,"fn__size200",!a[3]&&a[4]),l&8&&E(t,"fn__flex-center",!a[3])},d(a){a&&S(t),s=!1,I(i)}}}function Wi(e){let t,n,o;return{c(){t=O("input"),t.disabled=e[2],k(t,"class","b3-text-field"),k(t,"placeholder",e[5]),E(t,"fn__block",e[3]),E(t,"fn__size200",!e[3]&&e[4]),E(t,"fn__flex-center",!e[3])},m(r,s){N(r,t,s),Q(t,e[0]),n||(o=[F(t,"input",e[13]),F(t,"change",e[10])],n=!0)},p(r,s){s&4&&(t.disabled=r[2]),s&32&&k(t,"placeholder",r[5]),s&65&&t.value!==r[0]&&Q(t,r[0]),s&8&&E(t,"fn__block",r[3]),s&24&&E(t,"fn__size200",!r[3]&&r[4]),s&8&&E(t,"fn__flex-center",!r[3])},d(r){r&&S(t),n=!1,I(o)}}}function Vi(e){let t,n,o;return{c(){t=O("input"),t.disabled=e[2],k(t,"class","b3-switch svelte-edt8og"),k(t,"type","checkbox"),E(t,"fn__block",e[3]),E(t,"fn__flex-center",!e[3])},m(r,s){N(r,t,s),t.checked=e[0],n||(o=[F(t,"change",e[12]),F(t,"change",e[10])],n=!0)},p(r,s){s&4&&(t.disabled=r[2]),s&65&&(t.checked=r[0]),s&8&&E(t,"fn__block",r[3]),s&8&&E(t,"fn__flex-center",!r[3])},d(r){r&&S(t),n=!1,I(o)}}}function mn(e,t){let n,o=t[19].text+"",r,s;return{key:e,first:null,c(){n=O("option"),r=_e(o),n.__value=s=t[19].key,n.value=n.__value,this.first=n},m(i,a){N(i,n,a),R(n,r)},p(i,a){t=i,a&64&&o!==(o=t[19].text+"")&&xe(r,o),a&64&&s!==(s=t[19].key)&&(n.__value=s,n.value=n.__value)},d(i){i&&S(n)}}}function Gi(e){let t;function n(s,i){if(s[1]===Z.checkbox)return Vi;if(s[1]===Z.text)return Wi;if(s[1]===Z.number)return Hi;if(s[1]===Z.slider)return zi;if(s[1]===Z.button)return Ui;if(s[1]===Z.select)return Ii;if(s[1]===Z.textarea)return ji}let o=n(e),r=o&&o(e);return{c(){r&&r.c(),t=ge()},m(s,i){r&&r.m(s,i),N(s,t,i)},p(s,[i]){o===(o=n(s))&&r?r.p(s,i):(r&&r.d(1),r=o&&o(s),r&&(r.c(),r.m(t.parentNode,t)))},i:U,o:U,d(s){r&&r.d(s),s&&S(t)}}}function Ji(e,t,n){let{type:o}=t,{settingKey:r}=t,{settingValue:s}=t,{disabled:i=!1}=t,{block:a=!1}=t,{normal:l=!0}=t,{placeholder:u=""}=t,{options:c=[]}=t,{limits:_={min:0,max:100,step:1}}=t,{height:g=0}=t;const d=Tt();function b(C){d("clicked",{event:C})}function m(C){d("changed",{key:r,value:s,event:C})}function f(){s=this.checked,n(0,s),n(6,c)}function y(){s=this.value,n(0,s),n(6,c)}function M(){s=mt(this.value),n(0,s),n(6,c)}function Y(){s=mt(this.value),n(0,s),n(6,c)}function ye(){s=fi(this),n(0,s),n(6,c)}function ke(){s=this.value,n(0,s),n(6,c)}return e.$$set=C=>{"type"in C&&n(1,o=C.type),"settingKey"in C&&n(11,r=C.settingKey),"settingValue"in C&&n(0,s=C.settingValue),"disabled"in C&&n(2,i=C.disabled),"block"in C&&n(3,a=C.block),"normal"in C&&n(4,l=C.normal),"placeholder"in C&&n(5,u=C.placeholder),"options"in C&&n(6,c=C.options),"limits"in C&&n(7,_=C.limits),"height"in C&&n(8,g=C.height)},[s,o,i,a,l,u,c,_,g,b,m,r,f,y,M,Y,ye,ke]}class Ot extends ce{constructor(t){super(),le(this,t,Ji,Gi,ae,{type:1,settingKey:11,settingValue:0,disabled:2,block:3,normal:4,placeholder:5,options:6,limits:7,height:8})}}function Ki(e){let t,n,o,r,s;const i=e[2].default,a=x(i,e,e[1],null);return{c(){t=O("div"),n=new Et(!1),o=q(),r=O("div"),a&&a.c(),n.a=o,k(r,"class","config-query"),k(t,"class","b3-label")},m(l,u){N(l,t,u),n.m(e[0],t),R(t,o),R(t,r),a&&a.m(r,null),s=!0},p(l,[u]){(!s||u&1)&&n.p(l[0]),a&&a.p&&(!s||u&2)&&ee(a,i,l,l[1],s?$(i,l[1],u,null):te(l[1]),null)},i(l){s||(v(a,l),s=!0)},o(l){A(a,l),s=!1},d(l){l&&S(t),a&&a.d(l)}}}function Qi(e,t,n){let{$$slots:o={},$$scope:r}=t,{title:s}=t;return e.$$set=i=>{"title"in i&&n(0,s=i.title),"$$scope"in i&&n(1,r=i.$$scope)},[s,r,o]}class Yi extends ce{constructor(t){super(),le(this,t,Qi,Ki,ae,{title:0})}}const Zi=e=>({}),bn=e=>({}),Xi=e=>({}),gn=e=>({}),xi=e=>({}),_n=e=>({});function $i(e){let t,n,o,r,s,i,a,l,u;const c=e[3].icon,_=x(c,e,e[2],_n),g=e[3].title,d=x(g,e,e[2],gn),b=e[3].input,m=x(b,e,e[2],bn);return{c(){t=O("label"),_&&_.c(),n=q(),o=O("span"),r=q(),s=O("div"),d&&d.c(),i=q(),a=O("span"),l=q(),m&&m.c(),k(o,"class","fn__space"),k(s,"class","fn__flex-1"),k(a,"class","fn__space"),oe(t,"min-width",e[0]),oe(t,"margin-right",e[1]),k(t,"class","fn__flex svelte-1l7osn9")},m(f,y){N(f,t,y),_&&_.m(t,null),R(t,n),R(t,o),R(t,r),R(t,s),d&&d.m(s,null),R(t,i),R(t,a),R(t,l),m&&m.m(t,null),u=!0},p(f,[y]){_&&_.p&&(!u||y&4)&&ee(_,c,f,f[2],u?$(c,f[2],y,xi):te(f[2]),_n),d&&d.p&&(!u||y&4)&&ee(d,g,f,f[2],u?$(g,f[2],y,Xi):te(f[2]),gn),m&&m.p&&(!u||y&4)&&ee(m,b,f,f[2],u?$(b,f[2],y,Zi):te(f[2]),bn),(!u||y&1)&&oe(t,"min-width",f[0]),(!u||y&2)&&oe(t,"margin-right",f[1])},i(f){u||(v(_,f),v(d,f),v(m,f),u=!0)},o(f){A(_,f),A(d,f),A(m,f),u=!1},d(f){f&&S(t),_&&_.d(f),d&&d.d(f),m&&m.d(f)}}}function ea(e,t,n){let{$$slots:o={},$$scope:r}=t,{minWidth:s="24em"}=t,{marginRight:i="2em"}=t;return e.$$set=a=>{"minWidth"in a&&n(0,s=a.minWidth),"marginRight"in a&&n(1,i=a.marginRight),"$$scope"in a&&n(2,r=a.$$scope)},[s,i,r,o]}class _o extends ce{constructor(t){super(),le(this,t,ea,$i,ae,{minWidth:0,marginRight:1})}}var D=(e=>(e[e.input=0]="input",e[e.button=1]="button",e[e.separator=2]="separator",e))(D||{}),P=(e=>(e[e.edit=0]="edit",e[e.update=1]="update",e[e.delete=2]="delete",e[e.switch=3]="switch",e[e.insert=4]="insert",e[e.remove=5]="remove",e[e.toggle=6]="toggle",e[e.replace=7]="replace",e[e.fullscreen=8]="fullscreen",e))(P||{});function yn(e,t,n){const o=e.slice();return o[10]=t[n],o[11]=t,o[12]=n,o}function ta(e){let t,n;return t=new Ot({props:{slot:"input",type:Z.button,settingKey:"Reset",settingValue:e[1].settings.generalSettings.reset.text}}),t.$on("clicked",e[3]),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p:U,i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function na(e){let t,n;return t=new Li({props:{title:e[1].settings.generalSettings.reset.title,text:e[1].settings.generalSettings.reset.description,$$slots:{input:[ta]},$$scope:{ctx:e}}}),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p(o,r){const s={};r&8192&&(s.$$scope={dirty:r,ctx:o}),t.$set(s)},i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function kn(e){let t,n;return t=new Yi({props:{title:e[1].menu[e[10].id].label,$$slots:{default:[ca]},$$scope:{ctx:e}}}),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p(o,r){const s={};r&1&&(s.title=o[1].menu[o[10].id].label),r&8193&&(s.$$scope={dirty:r,ctx:o}),t.$set(s)},i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function oa(e){let t,n;return t=new $e({props:{slot:"icon",icon:"#iconMenu",className:"svg"}}),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p:U,i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function ra(e){let t;return{c(){t=O("span"),t.textContent=`${e[1].settings.featureSettings.menu.label}`,k(t,"slot","title")},m(n,o){N(n,t,o)},p:U,d(n){n&&S(t)}}}function sa(e){let t,n;function o(...r){return e[6](e[10],e[11],e[12],...r)}return t=new Ot({props:{slot:"input",type:Z.checkbox,settingKey:"Checkbox",settingValue:e[10].enable}}),t.$on("changed",o),{c(){W(t.$$.fragment)},m(r,s){z(t,r,s),n=!0},p(r,s){e=r;const i={};s&1&&(i.settingValue=e[10].enable),t.$set(i)},i(r){n||(v(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){H(t,r)}}}function wn(e){let t,n;return t=new _o({props:{minWidth:"12em",$$slots:{input:[la],title:[aa],icon:[ia]},$$scope:{ctx:e}}}),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p(o,r){const s={};r&8193&&(s.$$scope={dirty:r,ctx:o}),t.$set(s)},i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function ia(e){let t,n;return t=new $e({props:{slot:"icon",icon:"#iconTheme",className:"svg"}}),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p:U,i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function aa(e){let t;return{c(){t=O("span"),t.textContent=`${e[1].settings.featureSettings.style.label}`,k(t,"slot","title")},m(n,o){N(n,t,o)},p:U,d(n){n&&S(t)}}}function la(e){let t,n;function o(...r){return e[7](e[10],e[11],e[12],...r)}return t=new Ot({props:{slot:"input",type:Z.checkbox,settingKey:"Checkbox",settingValue:e[10].style}}),t.$on("changed",o),{c(){W(t.$$.fragment)},m(r,s){z(t,r,s),n=!0},p(r,s){e=r;const i={};s&1&&(i.settingValue=e[10].style),t.$set(i)},i(r){n||(v(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){H(t,r)}}}function ca(e){let t,n,o,r;t=new _o({props:{minWidth:"12em",$$slots:{input:[sa],title:[ra],icon:[oa]},$$scope:{ctx:e}}});let s=e[10].style!==void 0&&wn(e);return{c(){W(t.$$.fragment),n=q(),s&&s.c(),o=q()},m(i,a){z(t,i,a),N(i,n,a),s&&s.m(i,a),N(i,o,a),r=!0},p(i,a){const l={};a&8193&&(l.$$scope={dirty:a,ctx:i}),t.$set(l),i[10].style!==void 0?s?(s.p(i,a),a&1&&v(s,1)):(s=wn(i),s.c(),v(s,1),s.m(o.parentNode,o)):s&&(de(),A(s,1,1,()=>{s=null}),pe())},i(i){r||(v(t.$$.fragment,i),v(s),r=!0)},o(i){A(t.$$.fragment,i),A(s),r=!1},d(i){H(t,i),i&&S(n),s&&s.d(i),i&&S(o)}}}function Sn(e,t){let n,o,r,s=t[10].mode!==D.separator&&kn(t);return{key:e,first:null,c(){n=ge(),s&&s.c(),o=ge(),this.first=n},m(i,a){N(i,n,a),s&&s.m(i,a),N(i,o,a),r=!0},p(i,a){t=i,t[10].mode!==D.separator?s?(s.p(t,a),a&1&&v(s,1)):(s=kn(t),s.c(),v(s,1),s.m(o.parentNode,o)):s&&(de(),A(s,1,1,()=>{s=null}),pe())},i(i){r||(v(s),r=!0)},o(i){A(s),r=!1},d(i){i&&S(n),s&&s.d(i),i&&S(o)}}}function ua(e){let t=[],n=new Map,o,r,s=e[0].features;const i=a=>a[12];for(let a=0;a<s.length;a+=1){let l=yn(e,s,a),u=i(l);n.set(u,t[a]=Sn(u,l))}return{c(){for(let a=0;a<t.length;a+=1)t[a].c();o=ge()},m(a,l){for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(a,l);N(a,o,l),r=!0},p(a,l){l&7&&(s=a[0].features,de(),t=At(t,l,i,1,a,s,n,o.parentNode,go,Sn,o,yn),pe())},i(a){if(!r){for(let l=0;l<s.length;l+=1)v(t[l]);r=!0}},o(a){for(let l=0;l<t.length;l+=1)A(t[l]);r=!1},d(a){for(let l=0;l<t.length;l+=1)t[l].d(a);a&&S(o)}}}function fa(e){let t,n,o,r;return t=new an({props:{display:e[4][0].key===e[9],$$slots:{default:[na]},$$scope:{ctx:e}}}),o=new an({props:{display:e[4][1].key===e[9],$$slots:{default:[ua]},$$scope:{ctx:e}}}),{c(){W(t.$$.fragment),n=q(),W(o.$$.fragment)},m(s,i){z(t,s,i),N(s,n,i),z(o,s,i),r=!0},p(s,i){const a={};i&512&&(a.display=s[4][0].key===s[9]),i&8192&&(a.$$scope={dirty:i,ctx:s}),t.$set(a);const l={};i&512&&(l.display=s[4][1].key===s[9]),i&8193&&(l.$$scope={dirty:i,ctx:s}),o.$set(l)},i(s){r||(v(t.$$.fragment,s),v(o.$$.fragment,s),r=!0)},o(s){A(t.$$.fragment,s),A(o.$$.fragment,s),r=!1},d(s){H(t,s),s&&S(n),H(o,s)}}}function da(e){let t,n;return t=new Ti({props:{panels:e[4],focus:pa,$$slots:{default:[fa,({focus:o})=>({9:o}),({focus:o})=>o?512:0]},$$scope:{ctx:e}}}),{c(){W(t.$$.fragment)},m(o,r){z(t,o,r),n=!0},p(o,[r]){const s={};r&8705&&(s.$$scope={dirty:r,ctx:o}),t.$set(s)},i(o){n||(v(t.$$.fragment,o),n=!0)},o(o){A(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}let pa=0;function ha(e,t,n){let{config:o}=t,{plugin:r}=t;const s=r.i18n;function i(){r.updateConfig(o)}function a(){r.siyuan.confirm(s.settings.generalSettings.reset.title,s.settings.generalSettings.reset.description,async()=>{await r.resetConfig(),globalThis.location.reload()})}var l=(g=>(g[g.general=0]="general",g[g.feature=1]="feature",g))(l||{});const u=[{key:0,text:s.settings.generalSettings.title,name:s.settings.generalSettings.title,icon:"#iconSettings"},{key:1,text:s.settings.featureSettings.title,name:s.settings.featureSettings.title,icon:"#iconMenu"}],c=(g,d,b,m)=>{n(0,d[b].enable=m.detail.value,o),i()},_=(g,d,b,m)=>{n(0,d[b].style=m.detail.value,o),i()};return e.$$set=g=>{"config"in g&&n(0,o=g.config),"plugin"in g&&n(5,r=g.plugin)},[o,s,i,a,u,r,c,_]}class ma extends ce{constructor(t){super(),le(this,t,ha,da,ae,{config:0,plugin:5})}}const at={version:"1.1.1",features:[{id:"custom-block-style",enable:!0,mode:D.input,multi:!0,icon:"#iconTheme",type:{default:{enable:!0},[w.NodeType.NodeDocument]:{enable:!1}},tasks:[{type:P.edit,params:{name:"style"}}]},{id:"custom-block-separator-1F23B9BB-BD9C-41A1-830E-F48D23618889",enable:!0,mode:D.separator,multi:!1,type:{default:{enable:!0},[w.NodeType.NodeDocument]:{enable:!1}}},{id:"custom-block-fullscreen",enable:!0,mode:D.button,multi:!1,icon:"iconFullscreen",tasks:[{type:P.fullscreen}]},{id:"custom-block-width-full",enable:!0,mode:D.button,multi:!1,icon:"iconHideDock",accelerator:"width: full",style:!0,token:"width-full",type:{default:{enable:!1},[w.NodeType.NodeAudio]:{enable:!0},[w.NodeType.NodeIFrame]:{enable:!0},[w.NodeType.NodeVideo]:{enable:!0},[w.NodeType.NodeWidget]:{enable:!0}},tasks:[{type:P.toggle,params:{name:"custom-block-width",token:"full"}}]},{id:"custom-block-position-sticky",enable:!0,mode:D.button,multi:!0,icon:"iconPin",accelerator:"position: sticky",style:!0,token:"position-sticky",type:{default:{enable:!0},[w.NodeType.NodeDocument]:{enable:!1}},tasks:[{type:P.toggle,params:{name:"custom-block-position",token:"sticky"}}]},{id:"custom-block-separator-85642773-CEF8-4D0B-AFDF-BC450D162BEB",enable:!0,mode:D.separator,multi:!1},{id:"custom-block-render-danmaku",enable:!0,mode:D.button,multi:!0,icon:"icon-custom-block-render-danmaku",accelerator:"render: danmaku",style:!0,token:"render-danmaku",tasks:[{type:P.toggle,params:{name:"custom-block-render",token:"danmaku"}}]},{id:"custom-block-render-scroll",enable:!0,mode:D.button,multi:!0,icon:"iconScrollWrapped",accelerator:"render: scroll",style:!0,token:"render-scroll",type:{default:{enable:!0},[w.NodeType.NodeTable]:{enable:!1}},tasks:[{type:P.toggle,params:{name:"custom-block-render",token:"scroll"}}]},{id:"custom-block-separator-71DD3901-AA75-412F-B764-17346468357D",enable:!0,mode:D.separator,multi:!0},{id:"custom-block-render-id",enable:!0,mode:D.button,multi:!0,icon:"iconInfo",accelerator:"render: id",style:!0,token:"render-id",tasks:[{type:P.toggle,params:{name:"custom-block-render",token:"id"}}]},{id:"custom-block-render-index",enable:!0,mode:D.button,multi:!1,icon:"iconOrderedList",accelerator:"render: index",style:!0,token:"render-index",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0}},tasks:[{type:P.toggle,params:{name:"custom-block-render",token:"index"}}]},{id:"custom-block-render-content",enable:!0,mode:D.button,multi:!0,icon:"iconMarkdown",accelerator:"render: content",style:!0,token:"render-content",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeListItem]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0},[w.NodeType.NodeHeading]:{enable:!0},[w.NodeType.NodeParagraph]:{enable:!0},[w.NodeType.NodeMathBlock]:{enable:!0},[w.NodeType.NodeTable]:{enable:!0},[w.NodeType.NodeCodeBlock]:{enable:!0},[w.NodeType.NodeHTMLBlock]:{enable:!0}},tasks:[{type:P.toggle,params:{name:"custom-block-render",token:"content"}}]},{id:"custom-block-render-outline",enable:!0,mode:D.button,multi:!0,icon:"iconMax",accelerator:"render: outline",style:!0,token:"render-outline",tasks:[{type:P.toggle,params:{name:"custom-block-render",token:"outline"}}]},{id:"custom-block-separator-C55B65F3-4470-4C3A-B6D2-81A760634A11",enable:!0,mode:D.separator,multi:!0},{id:"custom-block-writing-mode",enable:!0,mode:D.button,multi:!0,icon:"iconEdit",accelerator:"writing-mode",style:!0,token:"writing-mode",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeListItem]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeHeading]:{enable:!0},[w.NodeType.NodeParagraph]:{enable:!0},[w.NodeType.NodeTable]:{enable:!0}},tasks:[{type:P.switch,params:{name:"custom-block-writing-mode",values:["vertical-rl","vertical-lr",null]}}]},{id:"custom-block-separator-B320E3AA-01A7-45AB-8C64-B58578CDA111",enable:!0,mode:D.separator,multi:!0,type:{default:{enable:!1},[w.NodeType.NodeTable]:{enable:!0}}},{id:"custom-block-table-width-default",enable:!0,mode:D.button,multi:!0,icon:"iconUndo",accelerator:"table-width: null",type:{default:{enable:!1},[w.NodeType.NodeTable]:{enable:!0}},tasks:[{type:P.delete,params:{name:"custom-block-table-width"}}]},{id:"custom-block-table-width-auto",enable:!0,mode:D.button,multi:!0,icon:"icon-custom-block-width-auto",accelerator:"table-width: auto",style:!0,token:"table-width-auto",type:{default:{enable:!1},[w.NodeType.NodeTable]:{enable:!0}},tasks:[{type:P.update,params:{name:"custom-block-table-width",value:"auto"}}]},{id:"custom-block-table-width-equal",enable:!0,mode:D.button,multi:!0,icon:"icon-custom-block-width-equal",accelerator:"table-width: equal",style:!0,token:"table-width-equal",type:{default:{enable:!1},[w.NodeType.NodeTable]:{enable:!0}},tasks:[{type:P.update,params:{name:"custom-block-table-width",value:"equal"}}]},{id:"custom-block-separator-92B49367-D643-4AEC-B90F-7EB86DF4890A",enable:!0,mode:D.separator,multi:!0,type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0}}},{id:"custom-block-list-view-default",enable:!0,mode:D.button,multi:!0,icon:"iconList",accelerator:"list-view: null",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0}},tasks:[{type:P.delete,params:{name:"custom-block-list-view"}}]},{id:"custom-block-list-view-map",enable:!0,mode:D.button,multi:!0,icon:"iconGraph",accelerator:"list-view: map",style:!0,token:"list-view-map",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0}},tasks:[{type:P.update,params:{name:"custom-block-list-view",value:"map"}}]},{id:"custom-block-list-view-table",enable:!0,mode:D.button,multi:!0,icon:"iconTable",accelerator:"list-view: table",style:!0,token:"list-view-table",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0}},tasks:[{type:P.update,params:{name:"custom-block-list-view",value:"table"}}]},{id:"custom-block-list-view-board",enable:!0,mode:D.button,multi:!0,icon:"iconSplitLR",accelerator:"list-view: board",style:!0,token:"list-view-board",type:{default:{enable:!1},[w.NodeType.NodeDocument]:{enable:!0},[w.NodeType.NodeSuperBlock]:{enable:!0},[w.NodeType.NodeList]:{enable:!0},[w.NodeType.NodeBlockquote]:{enable:!0},[w.NodeType.NodeBlockQueryEmbed]:{enable:!0}},tasks:[{type:P.update,params:{name:"custom-block-list-view",value:"board"}}]}]};function ba(e,t){if(e.type){const n=e.type[t.type];if(n){if(!n.enable)return!1}else if(e.type.default&&!e.type.default.enable)return!1}if(e.subtype){const n=e.subtype[t.subtype];if(n){if(!n.enable)return!1}else if(e.subtype.default&&!e.subtype.default.enable)return!1}return!0}function ga(e,t){return!(t.isMultiBlock&&!e.multi||t.blocks.find(n=>!ba(e,n)))}const _a=e=>({}),Nn=e=>({});function ya(e){let t;const n=e[16].icon,o=x(n,e,e[15],Nn),r=o||wa();return{c(){r&&r.c()},m(s,i){r&&r.m(s,i),t=!0},p(s,i){o&&o.p&&(!t||i&32768)&&ee(o,n,s,s[15],t?$(n,s[15],i,_a):te(s[15]),Nn)},i(s){t||(v(r,s),t=!0)},o(s){A(r,s),t=!1},d(s){r&&r.d(s)}}}function ka(e){let t,n;return{c(){t=be("svg"),n=be("use"),Pe(n,"xlink:href",e[1]),k(t,"class","b3-menu__icon")},m(o,r){N(o,t,r),R(t,n)},p(o,r){r&2&&Pe(n,"xlink:href",o[1])},i:U,o:U,d(o){o&&S(t)}}}function wa(e){let t,n;return{c(){t=be("svg"),n=be("use"),Pe(n,"xlink:href","#"),k(t,"class","b3-menu__icon")},m(o,r){N(o,t,r),R(t,n)},p:U,d(o){o&&S(t)}}}function Sa(e){let t,n,o,r,s,i,a;return{c(){t=O("div"),n=q(),o=O("input"),r=q(),s=O("div"),k(t,"class","fn__hr--small"),o.disabled=e[4],k(o,"placeholder",e[3]),k(o,"class","b3-text-field fn__size200"),k(s,"class","fn__hr--small")},m(l,u){N(l,t,u),N(l,n,u),N(l,o,u),e[17](o),Q(o,e[0]),N(l,r,u),N(l,s,u),i||(a=[F(o,"input",e[18]),F(o,"change",e[12])],i=!0)},p(l,u){u&16&&(o.disabled=l[4]),u&8&&k(o,"placeholder",l[3]),u&1&&o.value!==l[0]&&Q(o,l[0])},d(l){l&&S(t),l&&S(n),l&&S(o),e[17](null),l&&S(r),l&&S(s),i=!1,I(a)}}}function Na(e){let t;return{c(){t=_e(e[3])},m(n,o){N(n,t,o)},p(n,o){o&8&&xe(t,n[3])},d(n){n&&S(t)}}}function vn(e){let t,n,o;return{c(){t=O("input"),k(t,"type","file"),k(t,"accept",e[8]),t.disabled=e[4],t.multiple=e[9],k(t,"class","file-input svelte-14whws2")},m(r,s){N(r,t,s),e[19](t),n||(o=[F(t,"change",e[20]),F(t,"change",e[13])],n=!0)},p(r,s){s&256&&k(t,"accept",r[8]),s&16&&(t.disabled=r[4]),s&512&&(t.multiple=r[9])},d(r){r&&S(t),e[19](null),n=!1,I(o)}}}function En(e){let t,n;return{c(){t=O("span"),n=_e(e[6]),k(t,"class","b3-menu__accelerator")},m(o,r){N(o,t,r),R(t,n)},p(o,r){r&64&&xe(n,o[6])},d(o){o&&S(t)}}}function va(e){let t,n,o,r,s,i,a,l;const u=[ka,ya],c=[];function _(y,M){return y[1]?0:1}t=_(e),n=c[t]=u[t](e);function g(y,M){return!y[5]||y[7]?Na:Sa}let d=g(e),b=d(e),m=e[7]&&vn(e),f=e[6]&&En(e);return{c(){n.c(),o=q(),r=O("span"),b.c(),s=q(),m&&m.c(),i=q(),f&&f.c(),a=ge(),k(r,"class","b3-menu__label"),oe(r,"font",e[2]),oe(r,"position",e[7]?"relative":"initial")},m(y,M){c[t].m(y,M),N(y,o,M),N(y,r,M),b.m(r,null),R(r,s),m&&m.m(r,null),N(y,i,M),f&&f.m(y,M),N(y,a,M),l=!0},p(y,[M]){let Y=t;t=_(y),t===Y?c[t].p(y,M):(de(),A(c[Y],1,1,()=>{c[Y]=null}),pe(),n=c[t],n?n.p(y,M):(n=c[t]=u[t](y),n.c()),v(n,1),n.m(o.parentNode,o)),d===(d=g(y))&&b?b.p(y,M):(b.d(1),b=d(y),b&&(b.c(),b.m(r,s))),y[7]?m?m.p(y,M):(m=vn(y),m.c(),m.m(r,null)):m&&(m.d(1),m=null),M&4&&oe(r,"font",y[2]),M&128&&oe(r,"position",y[7]?"relative":"initial"),y[6]?f?f.p(y,M):(f=En(y),f.c(),f.m(a.parentNode,a)):f&&(f.d(1),f=null)},i(y){l||(v(n),l=!0)},o(y){A(n),l=!1},d(y){c[t].d(y),y&&S(o),y&&S(r),b.d(),m&&m.d(),y&&S(i),f&&f.d(y),y&&S(a)}}}function Ea(e,t,n){let{$$slots:o={},$$scope:r}=t,{icon:s=""}=t,{font:i=""}=t,{label:a=""}=t,{disabled:l=!1}=t,{input:u=!1}=t,{value:c=""}=t,{accelerator:_=""}=t,{file:g=!1}=t,{accept:d=""}=t,{multiple:b=!0}=t,{webkitdirectory:m=!0}=t,f=null,y;function M(T){y&&n(11,y.webkitdirectory=T,y)}pi(()=>{M(m)});const Y=Tt();function ye(T){Y("changed",{value:c,event:T})}function ke(T){Y("selected",{files:f,event:T})}function C(T){Ge[T?"unshift":"push"](()=>{y=T,n(11,y)})}function L(){c=this.value,n(0,c)}function V(T){Ge[T?"unshift":"push"](()=>{y=T,n(11,y)})}function G(){f=this.files,n(10,f)}return e.$$set=T=>{"icon"in T&&n(1,s=T.icon),"font"in T&&n(2,i=T.font),"label"in T&&n(3,a=T.label),"disabled"in T&&n(4,l=T.disabled),"input"in T&&n(5,u=T.input),"value"in T&&n(0,c=T.value),"accelerator"in T&&n(6,_=T.accelerator),"file"in T&&n(7,g=T.file),"accept"in T&&n(8,d=T.accept),"multiple"in T&&n(9,b=T.multiple),"webkitdirectory"in T&&n(14,m=T.webkitdirectory),"$$scope"in T&&n(15,r=T.$$scope)},e.$$.update=()=>{e.$$.dirty&16384&&M(m)},[c,s,i,a,l,u,_,g,d,b,f,y,ye,ke,m,r,o,C,L,V,G]}class Ta extends ce{constructor(t){super(),le(this,t,Ea,va,ae,{icon:1,font:2,label:3,disabled:4,input:5,value:0,accelerator:6,file:7,accept:8,multiple:9,webkitdirectory:14})}}function je(e){return e.trim().split(/\s+/)}function yo(e,t){return e.includes(t)?e:[...e,t]}function ko(e,t){return e.filter(n=>n!==t)}function Aa(e,t){return e.includes(t)?ko(e,t):yo(e,t)}function Oa(e,t,n){return e.map(o=>o===t?n:o)}const Tn={[P.edit]:async(e,t,n,o)=>{o.element.innerHTML="";const r=new Ta({target:o.element,props:{input:!0,disabled:!t.enable,icon:t.icon,label:e.i18n.menu[t.id].label,accelerator:o.name}});if(o.name==="style")r.$set({value:n.element.getAttribute(o.name)||""});else{const s=await e.client.getBlockAttrs({id:n.id});r.$set({value:s.data[o.name]||""})}r.$on("changed",async s=>{const i={[o.name]:s.detail.value},a=await Promise.allSettled(n.blocks.map(l=>e.client.setBlockAttrs({id:l.id,attrs:i})));if(o.name==="style"){const l=s.detail.value;a.forEach((u,c)=>{switch(u.status){case"fulfilled":n.blocks[c].element.setAttribute("style",l);break}})}})},[P.update]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:o.value}})})},[P.delete]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{(await e.client.getBlockAttrs({id:r.id})).data.hasOwnProperty(o.name)&&e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:null}})})},[P.switch]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{const i=(await e.client.getBlockAttrs({id:r.id})).data;let a;if(i.hasOwnProperty(o.name)){const l=o.values.findIndex(u=>u===i[o.name]);a=o.values[(l+1)%o.values.length]}else a=o.values[0];e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:a}})})},[P.insert]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{const i=(await e.client.getBlockAttrs({id:r.id})).data;let a;if(i.hasOwnProperty(o.name)){const l=je(i[o.name]);a=yo(l,o.token).join(" ")}else a=o.token;e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:a}})})},[P.remove]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{const i=(await e.client.getBlockAttrs({id:r.id})).data;let a;if(i.hasOwnProperty(o.name)){const l=je(i[o.name]);a=ko(l,o.token).join(" "),e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:a}})}})},[P.toggle]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{const i=(await e.client.getBlockAttrs({id:r.id})).data;let a;if(i.hasOwnProperty(o.name)){const l=je(i[o.name]);a=Aa(l,o.token).join(" ")}else a=o.token;e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:a}})})},[P.replace]:async(e,t,n,o)=>{n.blocks.forEach(async r=>{const i=(await e.client.getBlockAttrs({id:r.id})).data;let a;if(i.hasOwnProperty(o.name)){const l=je(i[o.name]);a=Oa(l,o.token,o.newToken).join(" "),e.client.setBlockAttrs({id:r.id,attrs:{[o.name]:a}})}})},[P.fullscreen]:async(e,t,n,o)=>{if(n.isDocumentBlock)n.element.parentElement.parentElement.classList.toggle("fullscreen");else{let r;switch(n.element.dataset.type){case"NodeVideo":r=n.element.querySelector("video");break;case"NodeIFrame":case"NodeWidget":r=n.element.querySelector("iframe");break;case"NodeHTMLBlock":r=n.element.querySelector("protyle-html");break;default:r=n.element;break}r.requestFullscreen()}}},fe=class fe extends he.Plugin{constructor(n){super(n);J(this,"siyuan",he);J(this,"logger");J(this,"client");J(this,"STYLE_ELEMENT_ID");J(this,"SETTINGS_DIALOG_ID");J(this,"SYSTEM_FONTS_DIALOG_ID");J(this,"USABLE_FONTS_DIALOG_ID");J(this,"config");J(this,"blockMenuEventListener",n=>{const o=n.detail,r=ai(o);if(r){const s=[];this.config.features.filter(a=>ga(a,r)).forEach(a=>{switch(a.mode){case D.input:{a.tasks.forEach(l=>{s.push({id:a.id,element:globalThis.document.createElement("div"),disabled:!a.enable,bind:u=>Tn[l.type](this,a,r,{element:u,...l.params})})});break}case D.button:{s.push({id:a.id,icon:a.icon,label:this.i18n.menu[a.id].label,accelerator:a.accelerator,disabled:!a.enable,click:async()=>{for(const l of a.tasks)await Tn[l.type](this,a,r,l.params)}});break}case D.separator:{s.push({type:"separator"});break}}}),o.menu.addItem({icon:"icon-custom-block-menu",label:this.i18n.displayName,submenu:s})}});this.logger=new Ws(this.name),this.client=new Is,this.SETTINGS_DIALOG_ID=`plugin-${this.name}-settings-dialog`}onload(){this.addIcons([No,vo,Eo,To].join("")),this.loadData(fe.GLOBAL_CONFIG_NAME).then(n=>{this.config=Zt(at,n||{})}).catch(n=>this.logger.error(n)).finally(()=>{this.eventBus.on("click-blockicon",this.blockMenuEventListener),this.eventBus.on("click-editortitleicon",this.blockMenuEventListener),this.updateRootAttr()})}onLayoutReady(){ii(this.config.version,at.version)<0&&he.confirm(`${this.i18n.config.reset.title} <code class="fn__code">${this.displayName} [${this.name}]</code>`,this.i18n.config.reset.description,async()=>{await this.resetConfig(),globalThis.location.reload()})}onunload(){this.eventBus.off("click-blockicon",this.blockMenuEventListener),this.eventBus.off("click-editortitleicon",this.blockMenuEventListener),this.removeRootAttr()}openSetting(){const n=this,o=new he.Dialog({title:`${this.i18n.displayName} <code class="fn__code">${this.name}</code>`,content:`<div id="${n.SETTINGS_DIALOG_ID}" class="fn__flex-column" />`,width:Qt?"92vw":"720px",height:Qt?void 0:"640px"});new ma({target:o.element.querySelector(`#${n.SETTINGS_DIALOG_ID}`),props:{config:this.config,plugin:this}})}async resetConfig(){return this.updateConfig(Zt(at))}async updateConfig(n){return n&&n!==this.config&&(this.config=n),this.updateRootAttr(),this.saveData(fe.GLOBAL_CONFIG_NAME,this.config)}updateRootAttr(){const o=this.config.features.filter(r=>r.enable&&r.style&&r.token).map(r=>r.token);globalThis.document.documentElement.setAttribute(fe.ROOT_ATTRIBUTE_NAME,o.join(" "))}removeRootAttr(){globalThis.document.documentElement.removeAttribute(fe.ROOT_ATTRIBUTE_NAME)}};J(fe,"GLOBAL_CONFIG_NAME","global-config"),J(fe,"ROOT_ATTRIBUTE_NAME","plugin-custom-block");let gt=fe;module.exports=gt;
